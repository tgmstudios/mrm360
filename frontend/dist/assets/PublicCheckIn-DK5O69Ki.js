import{d as E,u as T,a as j,b as L,c as M,e as Y,r as y,f as F,o as z,B as N,_ as Q,g as r,h as c,i as s,j as d,F as S,k as b,t as u,l as V,w as p,m as h}from"./index-GOY9N8V9.js";const A=E({__name:"PublicCheckIn",setup(D,{expose:t}){t();const _=T(),n=j(),x=L(),f=M(),w=Y(),v=y(null),B=y(!1),P=y(!1),i=y("idle"),m=y(""),C=F(()=>_.params.code);z(async()=>{await I()});const I=async()=>{var o,g,k;try{B.value=!0;const l=await x.fetchEventByCheckInCode(C.value);v.value=l,(o=l.checkIns)!=null&&o.some(e=>{var a;return e.userId===((a=f.user)==null?void 0:a.id)})&&(i.value="already-checked-in")}catch(l){console.error("Failed to load event:",l),v.value=null,((g=l==null?void 0:l.response)==null?void 0:g.status)===404?m.value="Event not found. The check-in code may be invalid or the event may have been removed.":((k=l==null?void 0:l.response)==null?void 0:k.status)===401?m.value="You need to be logged in to access this check-in page.":m.value="Failed to load event details. Please check your connection and try again."}finally{B.value=!1}},R={route:_,router:n,eventStore:x,authStore:f,toast:w,event:v,loading:B,checkInLoading:P,checkInStatus:i,errorMessage:m,checkInCode:C,loadEvent:I,checkIn:async()=>{var o,g,k,l;if(!(!v.value||!f.user)){P.value=!0;try{const e=await x.checkInUser(v.value.id,f.user.id);if(console.log("Check-in result:",e),e.success)i.value="success",w.success("Successfully checked in to the event!");else{i.value="error";let a=e.message||"Check-in failed";console.log("Original error message:",e.message),e.message&&e.message.includes("already checked in")?(a="You have already checked in to this event.",i.value="already-checked-in"):e.message&&e.message.includes("not found")?a="Event not found. Please check the QR code and try again.":e.message&&e.message.includes("Invalid QR code")?a="Invalid QR code. Please scan the correct QR code for this event.":e.message&&e.message.includes("requires manual RSVP")?(a="This event requires you to RSVP first. Please RSVP to the event before checking in.",i.value="rsvp-required"):e.message&&e.message.includes("full and has no waitlist")?(a="This event is full and has no waitlist. Please RSVP manually first.",i.value="event-full"):e.message&&e.message.includes("not eligible to RSVP")?(a="You are not eligible to RSVP to this event. Please RSVP manually first.",i.value="not-eligible"):e.message&&e.message.includes("would be placed on the waitlist")?(a="This event is full and you would be placed on the waitlist. Please RSVP manually first to join the waitlist.",i.value="would-be-waitlisted"):e.message&&e.message.includes("on the waitlist")?(a="You are on the waitlist for this event. Please wait for confirmation before checking in.",i.value="on-waitlist"):e.message&&e.message.includes("RSVP is declined")?(a="Your RSVP for this event is declined. Please RSVP again if you want to attend.",i.value="rsvp-declined"):e.message&&e.message.includes("RSVP status")&&(a="Your RSVP status prevents check-in. Please update your RSVP first.",i.value="rsvp-status-error"),m.value=a,w.error(a)}}catch(e){console.error("Failed to check in:",e),i.value="error";let a="An unexpected error occurred. Please try again.";((o=e==null?void 0:e.response)==null?void 0:o.status)===401?a="You need to be logged in to check in. Please log in and try again.":((g=e==null?void 0:e.response)==null?void 0:g.status)===403?a="You do not have permission to check in to this event.":((k=e==null?void 0:e.response)==null?void 0:k.status)===404?a="Event not found. Please check the QR code and try again.":((l=e==null?void 0:e.response)==null?void 0:l.status)>=500&&(a="Server error occurred. Please try again later."),m.value=a,w.error(a)}finally{P.value=!1}}},goBack:()=>{n.push("/dashboard")},viewEventDetails:()=>{var o;(o=v.value)!=null&&o.id&&n.push(`/events/${v.value.id}`)},formatDate:o=>o?new Date(o).toLocaleDateString():"TBD",formatTime:o=>o?new Date(o).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"TBD",BaseButton:N};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}}),q={class:"min-h-screen bg-gray-900 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8"},O={class:"max-w-md w-full space-y-8"},U={key:0,class:"text-center"},G={class:"bg-gray-800 shadow rounded-lg border border-gray-700 p-8"},H={class:"text-center"},J={class:"text-3xl font-bold text-gray-100 mb-2"},K={class:"text-gray-400 mb-6"},W={key:0,class:"mb-6"},X={key:1,class:"mb-6"},Z={class:"text-gray-300"},$={key:2,class:"mb-6"},ee={class:"mb-6"},te={class:"text-left bg-gray-700 rounded-lg p-4 mb-6"},se={class:"space-y-2 text-sm text-gray-300"},ne={key:0},ae={class:"text-center"},oe={class:"text-gray-400 mb-6"};function ie(D,t,_,n,x,f){return c(),r("div",q,[s("div",O,[d(" Loading State "),n.loading?(c(),r("div",U,t[0]||(t[0]=[s("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),s("p",{class:"mt-4 text-sm text-gray-400"},"Loading event...",-1)]))):n.event?(c(),r(S,{key:1},[d(" Event Check-in Form "),s("div",G,[s("div",H,[s("h2",J,u(n.event.title),1),s("p",K,u(n.formatDate(n.event.startTime))+" at "+u(n.formatTime(n.event.startTime)),1),d(" Check-in Status "),n.checkInStatus==="success"?(c(),r("div",W,t[1]||(t[1]=[V('<div class="w-16 h-16 bg-green-600 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div><h3 class="text-xl font-semibold text-green-400 mb-2">Check-in Successful!</h3><p class="text-gray-300">You have been checked in to this event.</p>',3)]))):n.checkInStatus==="error"?(c(),r("div",X,[t[2]||(t[2]=s("div",{class:"w-16 h-16 bg-red-600 rounded-full flex items-center justify-center mx-auto mb-4"},[s("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),t[3]||(t[3]=s("h3",{class:"text-xl font-semibold text-red-400 mb-2"},"Check-in Failed",-1)),s("p",Z,u(n.errorMessage),1)])):n.checkInStatus==="already-checked-in"?(c(),r("div",$,t[4]||(t[4]=[V('<div class="w-16 h-16 bg-yellow-600 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg></div><h3 class="text-xl font-semibold text-yellow-400 mb-2">Already Checked In</h3><p class="text-gray-300">You have already checked in to this event.</p>',3)]))):(c(),r(S,{key:3},[d(" Check-in Button "),s("div",ee,[b(n.BaseButton,{onClick:n.checkIn,variant:"primary",size:"lg",loading:n.checkInLoading,class:"w-full"},{default:p(()=>t[5]||(t[5]=[h(" Check In to Event ",-1)])),_:1,__:[5]},8,["loading"])])],2112)),d(" Event Details "),s("div",te,[t[9]||(t[9]=s("h4",{class:"text-sm font-medium text-gray-400 mb-2"},"Event Details",-1)),s("div",se,[s("div",null,[t[6]||(t[6]=s("span",{class:"font-medium"},"Category:",-1)),h(" "+u(n.event.category),1)]),s("div",null,[t[7]||(t[7]=s("span",{class:"font-medium"},"Attendance Type:",-1)),h(" "+u(n.event.attendanceType),1)]),n.event.description?(c(),r("div",ne,[t[8]||(t[8]=s("span",{class:"font-medium"},"Description:",-1)),h(" "+u(n.event.description),1)])):d("v-if",!0)])]),d(" View Event Details Button "),b(n.BaseButton,{onClick:n.viewEventDetails,variant:"primary",class:"w-full mb-3"},{default:p(()=>t[10]||(t[10]=[s("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),h(" View Event Details ",-1)])),_:1,__:[10]}),d(" Back Button "),b(n.BaseButton,{onClick:n.goBack,variant:"secondary",class:"w-full"},{default:p(()=>t[11]||(t[11]=[h(" Back to Dashboard ",-1)])),_:1,__:[11]})])])],2112)):(c(),r(S,{key:2},[d(" Error State "),s("div",ae,[t[13]||(t[13]=s("div",{class:"w-16 h-16 bg-red-600 rounded-full flex items-center justify-center mx-auto mb-4"},[s("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),t[14]||(t[14]=s("h3",{class:"text-xl font-semibold text-gray-100 mb-2"},"Unable to Load Event",-1)),s("p",oe,u(n.errorMessage||"The check-in code is invalid or the event doesn't exist."),1),b(n.BaseButton,{onClick:n.goBack,variant:"secondary"},{default:p(()=>t[12]||(t[12]=[h(" Back to Dashboard ",-1)])),_:1,__:[12]})])],2112))])])}const he=Q(A,[["render",ie],["__file","/workspace/frontend/src/pages/checkin/PublicCheckIn.vue"]]);export{he as default};
