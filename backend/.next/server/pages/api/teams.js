"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/teams";
exports.ids = ["pages/api/teams"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "bullmq":
/*!*************************!*\
  !*** external "bullmq" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("bullmq");

/***/ }),

/***/ "ioredis":
/*!**************************!*\
  !*** external "ioredis" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("ioredis");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "zod":
/*!**********************!*\
  !*** external "zod" ***!
  \**********************/
/***/ ((module) => {

module.exports = import("zod");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fteams&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fteams%2Findex.ts&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fteams&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fteams%2Findex.ts&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_teams_index_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/pages/api/teams/index.ts */ \"(api)/./src/pages/api/teams/index.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_teams_index_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_src_pages_api_teams_index_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_teams_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_teams_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/teams\",\n        pathname: \"/api/teams\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_teams_index_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnRlYW1zJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGc3JjJTJGcGFnZXMlMkZhcGklMkZ0ZWFtcyUyRmluZGV4LnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzJEO0FBQzNEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQywwREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsMERBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXJtMzYwLWJhY2tlbmQvP2NhZGEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3NyYy9wYWdlcy9hcGkvdGVhbXMvaW5kZXgudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS90ZWFtc1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3RlYW1zXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fteams&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fteams%2Findex.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/managers/backgroundTaskManager.ts":
/*!***********************************************!*\
  !*** ./src/managers/backgroundTaskManager.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BackgroundTaskManager: () => (/* binding */ BackgroundTaskManager)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _utils_logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/utils/logger */ \"(api)/./src/utils/logger.ts\");\n\n\nclass BackgroundTaskManager {\n    constructor(prisma){\n        this.prisma = prisma;\n    }\n    async createTask(params) {\n        const { name, description, entityType, entityId, subtaskNames = [] } = params;\n        try {\n            // Create parent task\n            const parentTask = await this.prisma.backgroundTask.create({\n                data: {\n                    name,\n                    description,\n                    entityType,\n                    entityId,\n                    status: _prisma_client__WEBPACK_IMPORTED_MODULE_0__.TaskStatus.PENDING,\n                    progress: 0\n                }\n            });\n            // Create subtasks as child BackgroundTask records\n            if (subtaskNames.length > 0) {\n                await this.prisma.backgroundTask.createMany({\n                    data: subtaskNames.map((subtaskName, index)=>({\n                            name: subtaskName,\n                            parentTaskId: parentTask.id,\n                            stepIndex: index,\n                            status: _prisma_client__WEBPACK_IMPORTED_MODULE_0__.TaskStatus.PENDING,\n                            progress: 0\n                        }))\n                });\n            }\n            const fullTask = await this.prisma.backgroundTask.findUnique({\n                where: {\n                    id: parentTask.id\n                },\n                include: {\n                    subtasks: true\n                }\n            });\n            _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.info(\"Background task created\", {\n                taskId: parentTask.id,\n                name\n            });\n            // non-null by construction\n            return fullTask;\n        } catch (error) {\n            _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error(\"Failed to create background task\", {\n                error,\n                name\n            });\n            throw error;\n        }\n    }\n    async markTaskRunning(taskId) {\n        await this.prisma.backgroundTask.update({\n            where: {\n                id: taskId\n            },\n            data: {\n                status: _prisma_client__WEBPACK_IMPORTED_MODULE_0__.TaskStatus.RUNNING,\n                startedAt: new Date()\n            }\n        });\n    }\n    async updateTaskProgress(taskId, progress) {\n        await this.prisma.backgroundTask.update({\n            where: {\n                id: taskId\n            },\n            data: {\n                progress\n            }\n        });\n    }\n    async markTaskCompleted(taskId, result) {\n        await this.prisma.backgroundTask.update({\n            where: {\n                id: taskId\n            },\n            data: {\n                status: _prisma_client__WEBPACK_IMPORTED_MODULE_0__.TaskStatus.COMPLETED,\n                finishedAt: new Date(),\n                progress: 100,\n                result\n            }\n        });\n    }\n    async markTaskFailed(taskId, errorMessage) {\n        await this.prisma.backgroundTask.update({\n            where: {\n                id: taskId\n            },\n            data: {\n                status: _prisma_client__WEBPACK_IMPORTED_MODULE_0__.TaskStatus.FAILED,\n                finishedAt: new Date(),\n                error: errorMessage\n            }\n        });\n    }\n    async markSubtaskRunning(taskId, stepIndex) {\n        const subtaskId = await this.getSubtaskId(taskId, stepIndex);\n        const subtask = await this.prisma.backgroundTask.update({\n            where: {\n                id: subtaskId\n            },\n            data: {\n                status: _prisma_client__WEBPACK_IMPORTED_MODULE_0__.TaskStatus.RUNNING,\n                startedAt: new Date(),\n                progress: 0\n            }\n        });\n        return subtask;\n    }\n    async updateSubtaskProgress(taskId, stepIndex, progress) {\n        await this.prisma.backgroundTask.update({\n            where: {\n                id: await this.getSubtaskId(taskId, stepIndex)\n            },\n            data: {\n                progress\n            }\n        });\n    }\n    async markSubtaskCompleted(taskId, stepIndex, result) {\n        await this.prisma.backgroundTask.update({\n            where: {\n                id: await this.getSubtaskId(taskId, stepIndex)\n            },\n            data: {\n                status: _prisma_client__WEBPACK_IMPORTED_MODULE_0__.TaskStatus.COMPLETED,\n                finishedAt: new Date(),\n                progress: 100,\n                result\n            }\n        });\n    }\n    async markSubtaskFailed(taskId, stepIndex, errorMessage) {\n        await this.prisma.backgroundTask.update({\n            where: {\n                id: await this.getSubtaskId(taskId, stepIndex)\n            },\n            data: {\n                status: _prisma_client__WEBPACK_IMPORTED_MODULE_0__.TaskStatus.FAILED,\n                finishedAt: new Date(),\n                error: errorMessage\n            }\n        });\n    }\n    async getTask(taskId) {\n        return this.prisma.backgroundTask.findUnique({\n            where: {\n                id: taskId\n            },\n            include: {\n                subtasks: true\n            }\n        });\n    }\n    async listTasks(params = {}) {\n        const page = params.page || 1;\n        const limit = params.limit || 20;\n        const skip = (page - 1) * limit;\n        const where = {};\n        if (params.entityType) where.entityType = params.entityType;\n        if (params.entityId) where.entityId = params.entityId;\n        const [total, tasks] = await Promise.all([\n            this.prisma.backgroundTask.count({\n                where\n            }),\n            this.prisma.backgroundTask.findMany({\n                where,\n                orderBy: {\n                    createdAt: \"desc\"\n                },\n                skip,\n                take: limit,\n                include: {\n                    subtasks: true\n                }\n            })\n        ]);\n        return {\n            data: tasks,\n            pagination: {\n                page,\n                limit,\n                total,\n                totalPages: Math.ceil(total / limit)\n            }\n        };\n    }\n    async getSubtaskId(taskId, stepIndex) {\n        const subtask = await this.prisma.backgroundTask.findFirst({\n            where: {\n                parentTaskId: taskId,\n                stepIndex\n            }\n        });\n        if (!subtask) {\n            throw new Error(`Subtask not found for task ${taskId} at step ${stepIndex}`);\n        }\n        return subtask.id;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvbWFuYWdlcnMvYmFja2dyb3VuZFRhc2tNYW5hZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBMEU7QUFDbEM7QUFFakMsTUFBTUU7SUFHWEMsWUFBWUMsTUFBb0IsQ0FBRTtRQUNoQyxJQUFJLENBQUNBLE1BQU0sR0FBR0E7SUFDaEI7SUFFQSxNQUFNQyxXQUFXQyxNQU1oQixFQUE0RDtRQUMzRCxNQUFNLEVBQUVDLElBQUksRUFBRUMsV0FBVyxFQUFFQyxVQUFVLEVBQUVDLFFBQVEsRUFBRUMsZUFBZSxFQUFFLEVBQUUsR0FBR0w7UUFDdkUsSUFBSTtZQUNGLHFCQUFxQjtZQUNyQixNQUFNTSxhQUFhLE1BQU0sSUFBSSxDQUFDUixNQUFNLENBQUNTLGNBQWMsQ0FBQ0MsTUFBTSxDQUFDO2dCQUN6REMsTUFBTTtvQkFDSlI7b0JBQ0FDO29CQUNBQztvQkFDQUM7b0JBQ0FNLFFBQVFoQixzREFBVUEsQ0FBQ2lCLE9BQU87b0JBQzFCQyxVQUFVO2dCQUNaO1lBQ0Y7WUFFQSxrREFBa0Q7WUFDbEQsSUFBSVAsYUFBYVEsTUFBTSxHQUFHLEdBQUc7Z0JBQzNCLE1BQU0sSUFBSSxDQUFDZixNQUFNLENBQUNTLGNBQWMsQ0FBQ08sVUFBVSxDQUFDO29CQUMxQ0wsTUFBTUosYUFBYVUsR0FBRyxDQUFDLENBQUNDLGFBQWFDLFFBQVc7NEJBQzlDaEIsTUFBTWU7NEJBQ05FLGNBQWNaLFdBQVdhLEVBQUU7NEJBQzNCQyxXQUFXSDs0QkFDWFAsUUFBUWhCLHNEQUFVQSxDQUFDaUIsT0FBTzs0QkFDMUJDLFVBQVU7d0JBQ1o7Z0JBQ0Y7WUFDRjtZQUVBLE1BQU1TLFdBQVcsTUFBTSxJQUFJLENBQUN2QixNQUFNLENBQUNTLGNBQWMsQ0FBQ2UsVUFBVSxDQUFDO2dCQUMzREMsT0FBTztvQkFBRUosSUFBSWIsV0FBV2EsRUFBRTtnQkFBQztnQkFDM0JLLFNBQVM7b0JBQUVDLFVBQVU7Z0JBQUs7WUFDNUI7WUFFQTlCLGlEQUFNQSxDQUFDK0IsSUFBSSxD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UyxNQUFNVjtnQkFDTjVCLFNBQVM7b0JBQUVDLFVBQVU7Z0JBQUs7WUFDNUI7U0FDRDtRQUNELE9BQU87WUFDTGhCLE1BQU04QztZQUNOUSxZQUFZO2dCQUNWWjtnQkFDQUM7Z0JBQ0FFO2dCQUNBVSxZQUFZQyxLQUFLQyxJQUFJLENBQUNaLFFBQVFGO1lBQ2hDO1FBQ0Y7SUFDRjtJQUVBLE1BQWNSLGFBQWFqQixNQUFjLEVBQUVQLFNBQWlCLEVBQW1CO1FBQzdFLE1BQU15QixVQUFVLE1BQU0sSUFBSSxDQUFDL0MsTUFBTSxDQUFDUyxjQUFjLENBQUM0RCxTQUFTLENBQUM7WUFBRTVDLE9BQU87Z0JBQUVMLGNBQWNTO2dCQUFRUDtZQUFVO1FBQUU7UUFDeEcsSUFBSSxDQUFDeUIsU0FBUztZQUNaLE1BQU0sSUFBSXVCLE1BQU0sQ0FBQywyQkFBMkIsRUFBRXpDLE9BQU8sU0FBUyxFQUFFUCxVQUFVLENBQUM7UUFDN0U7UUFDQSxPQUFPeUIsUUFBUTFCLEVBQUU7SUFDbkI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL21ybTM2MC1iYWNrZW5kLy4vc3JjL21hbmFnZXJzL2JhY2tncm91bmRUYXNrTWFuYWdlci50cz8xMDg0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCwgVGFza1N0YXR1cywgQmFja2dyb3VuZFRhc2sgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAL3V0aWxzL2xvZ2dlcic7XG5cbmV4cG9ydCBjbGFzcyBCYWNrZ3JvdW5kVGFza01hbmFnZXIge1xuICBwcml2YXRlIHByaXNtYTogUHJpc21hQ2xpZW50O1xuXG4gIGNvbnN0cnVjdG9yKHByaXNtYTogUHJpc21hQ2xpZW50KSB7XG4gICAgdGhpcy5wcmlzbWEgPSBwcmlzbWE7XG4gIH1cblxuICBhc3luYyBjcmVhdGVUYXNrKHBhcmFtczoge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgICBlbnRpdHlUeXBlPzogc3RyaW5nO1xuICAgIGVudGl0eUlkPzogc3RyaW5nO1xuICAgIHN1YnRhc2tOYW1lcz86IHN0cmluZ1tdO1xuICB9KTogUHJvbWlzZTxCYWNrZ3JvdW5kVGFzayAmIHsgc3VidGFza3M6IEJhY2tncm91bmRUYXNrW10gfT4ge1xuICAgIGNvbnN0IHsgbmFtZSwgZGVzY3JpcHRpb24sIGVudGl0eVR5cGUsIGVudGl0eUlkLCBzdWJ0YXNrTmFtZXMgPSBbXSB9ID0gcGFyYW1zO1xuICAgIHRyeSB7XG4gICAgICAvLyBDcmVhdGUgcGFyZW50IHRhc2tcbiAgICAgIGNvbnN0IHBhcmVudFRhc2sgPSBhd2FpdCB0aGlzLnByaXNtYS5iYWNrZ3JvdW5kVGFzay5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgbmFtZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbixcbiAgICAgICAgICBlbnRpdHlUeXBlLFxuICAgICAgICAgIGVudGl0eUlkLFxuICAgICAgICAgIHN0YXR1czogVGFza1N0YXR1cy5QRU5ESU5HLFxuICAgICAgICAgIHByb2dyZXNzOiAwXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBDcmVhdGUgc3VidGFza3MgYXMgY2hpbGQgQmFja2dyb3VuZFRhc2sgcmVjb3Jkc1xuICAgICAgaWYgKHN1YnRhc2tOYW1lcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGF3YWl0IHRoaXMucHJpc21hLmJhY2tncm91bmRUYXNrLmNyZWF0ZU1hbnkoe1xuICAgICAgICAgIGRhdGE6IHN1YnRhc2tOYW1lcy5tYXAoKHN1YnRhc2tOYW1lLCBpbmRleCkgPT4gKHtcbiAgICAgICAgICAgIG5hbWU6IHN1YnRhc2tOYW1lLFxuICAgICAgICAgICAgcGFyZW50VGFza0lkOiBwYXJlbnRUYXNrLmlkLFxuICAgICAgICAgICAgc3RlcEluZGV4OiBpbmRleCxcbiAgICAgICAgICAgIHN0YXR1czogVGFza1N0YXR1cy5QRU5ESU5HLFxuICAgICAgICAgICAgcHJvZ3Jlc3M6IDBcbiAgICAgICAgICB9KSlcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGZ1bGxUYXNrID0gYXdhaXQgdGhpcy5wcmlzbWEuYmFja2dyb3VuZFRhc2suZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBwYXJlbnRUYXNrLmlkIH0sXG4gICAgICAgIGluY2x1ZGU6IHsgc3VidGFza3M6IHRydWUgfVxuICAgICAgfSk7XG5cbiAgICAgIGxvZ2dlci5pbmZvKCdCYWNrZ3JvdW5kIHRhc2sgY3JlYXRlZCcsIHsgdGFza0lkOiBwYXJlbnRUYXNrLmlkLCBuYW1lIH0pO1xuICAgICAgLy8gbm9uLW51bGwgYnkgY29uc3RydWN0aW9uXG4gICAgICByZXR1cm4gZnVsbFRhc2sgYXMgQmFja2dyb3VuZFRhc2sgJiB7IHN1YnRhc2tzOiBCYWNrZ3JvdW5kVGFza1tdIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGNyZWF0ZSBiYWNrZ3JvdW5kIHRhc2snLCB7IGVycm9yLCBuYW1lIH0pO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgbWFya1Rhc2tSdW5uaW5nKHRhc2tJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5wcmlzbWEuYmFja2dyb3VuZFRhc2sudXBkYXRlKHtcbiAgICAgIHdoZXJlOiB7IGlkOiB0YXNrSWQgfSxcbiAgICAgIGRhdGE6IHsgc3RhdHVzOiBUYXNrU3RhdHVzLlJVTk5JTkcsIHN0YXJ0ZWRBdDogbmV3IERhdGUoKSB9XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyB1cGRhdGVUYXNrUHJvZ3Jlc3ModGFza0lkOiBzdHJpbmcsIHByb2dyZXNzOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLnByaXNtYS5iYWNrZ3JvdW5kVGFzay51cGRhdGUoe1xuICAgICAgd2hlcmU6IHsgaWQ6IHRhc2tJZCB9LFxuICAgICAgZGF0YTogeyBwcm9ncmVzcyB9XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBtYXJrVGFza0NvbXBsZXRlZCh0YXNrSWQ6IHN0cmluZywgcmVzdWx0PzogYW55KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5wcmlzbWEuYmFja2dyb3VuZFRhc2sudXBkYXRlKHtcbiAgICAgIHdoZXJlOiB7IGlkOiB0YXNrSWQgfSxcbiAgICAgIGRhdGE6IHsgc3RhdHVzOiBUYXNrU3RhdHVzLkNPTVBMRVRFRCwgZmluaXNoZWRBdDogbmV3IERhdGUoKSwgcHJvZ3Jlc3M6IDEwMCwgcmVzdWx0IH1cbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIG1hcmtUYXNrRmFpbGVkKHRhc2tJZDogc3RyaW5nLCBlcnJvck1lc3NhZ2U6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMucHJpc21hLmJhY2tncm91bmRUYXNrLnVwZGF0ZSh7XG4gICAgICB3aGVyZTogeyBpZDogdGFza0lkIH0sXG4gICAgICBkYXRhOiB7IHN0YXR1czogVGFza1N0YXR1cy5GQUlMRUQsIGZpbmlzaGVkQXQ6IG5ldyBEYXRlKCksIGVycm9yOiBlcnJvck1lc3NhZ2UgfVxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgbWFya1N1YnRhc2tSdW5uaW5nKHRhc2tJZDogc3RyaW5nLCBzdGVwSW5kZXg6IG51bWJlcik6IFByb21pc2U8QmFja2dyb3VuZFRhc2s+IHtcbiAgICBjb25zdCBzdWJ0YXNrSWQgPSBhd2FpdCB0aGlzLmdldFN1YnRhc2tJZCh0YXNrSWQsIHN0ZXBJbmRleCk7XG4gICAgY29uc3Qgc3VidGFzayA9IGF3YWl0IHRoaXMucHJpc21hLmJhY2tncm91bmRUYXNrLnVwZGF0ZSh7XG4gICAgICB3aGVyZTogeyBpZDogc3VidGFza0lkIH0sXG4gICAgICBkYXRhOiB7IHN0YXR1czogVGFza1N0YXR1cy5SVU5OSU5HLCBzdGFydGVkQXQ6IG5ldyBEYXRlKCksIHByb2dyZXNzOiAwIH1cbiAgICB9KTtcbiAgICByZXR1cm4gc3VidGFzaztcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZVN1YnRhc2tQcm9ncmVzcyh0YXNrSWQ6IHN0cmluZywgc3RlcEluZGV4OiBudW1iZXIsIHByb2dyZXNzOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLnByaXNtYS5iYWNrZ3JvdW5kVGFzay51cGRhdGUoe1xuICAgICAgd2hlcmU6IHsgaWQ6IGF3YWl0IHRoaXMuZ2V0U3VidGFza0lkKHRhc2tJZCwgc3RlcEluZGV4KSB9LFxuICAgICAgZGF0YTogeyBwcm9ncmVzcyB9XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBtYXJrU3VidGFza0NvbXBsZXRlZCh0YXNrSWQ6IHN0cmluZywgc3RlcEluZGV4OiBudW1iZXIsIHJlc3VsdD86IGFueSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMucHJpc21hLmJhY2tncm91bmRUYXNrLnVwZGF0ZSh7XG4gICAgICB3aGVyZTogeyBpZDogYXdhaXQgdGhpcy5nZXRTdWJ0YXNrSWQodGFza0lkLCBzdGVwSW5kZXgpIH0sXG4gICAgICBkYXRhOiB7IHN0YXR1czogVGFza1N0YXR1cy5DT01QTEVURUQsIGZpbmlzaGVkQXQ6IG5ldyBEYXRlKCksIHByb2dyZXNzOiAxMDAsIHJlc3VsdCB9XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBtYXJrU3VidGFza0ZhaWxlZCh0YXNrSWQ6IHN0cmluZywgc3RlcEluZGV4OiBudW1iZXIsIGVycm9yTWVzc2FnZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5wcmlzbWEuYmFja2dyb3VuZFRhc2sudXBkYXRlKHtcbiAgICAgIHdoZXJlOiB7IGlkOiBhd2FpdCB0aGlzLmdldFN1YnRhc2tJZCh0YXNrSWQsIHN0ZXBJbmRleCkgfSxcbiAgICAgIGRhdGE6IHsgc3RhdHVzOiBUYXNrU3RhdHVzLkZBSUxFRCwgZmluaXNoZWRBdDogbmV3IERhdGUoKSwgZXJyb3I6IGVycm9yTWVzc2FnZSB9XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBnZXRUYXNrKHRhc2tJZDogc3RyaW5nKTogUHJvbWlzZTwoQmFja2dyb3VuZFRhc2sgJiB7IHN1YnRhc2tzOiBCYWNrZ3JvdW5kVGFza1tdIH0pIHwgbnVsbD4ge1xuICAgIHJldHVybiB0aGlzLnByaXNtYS5iYWNrZ3JvdW5kVGFzay5maW5kVW5pcXVlKHsgd2hlcmU6IHsgaWQ6IHRhc2tJZCB9LCBpbmNsdWRlOiB7IHN1YnRhc2tzOiB0cnVlIH0gfSk7XG4gIH1cblxuICBhc3luYyBsaXN0VGFza3MocGFyYW1zOiB7IHBhZ2U/OiBudW1iZXI7IGxpbWl0PzogbnVtYmVyOyBlbnRpdHlUeXBlPzogc3RyaW5nOyBlbnRpdHlJZD86IHN0cmluZyB9ID0ge30pIHtcbiAgICBjb25zdCBwYWdlID0gcGFyYW1zLnBhZ2UgfHwgMTtcbiAgICBjb25zdCBsaW1pdCA9IHBhcmFtcy5saW1pdCB8fCAyMDtcbiAgICBjb25zdCBza2lwID0gKHBhZ2UgLSAxKSAqIGxpbWl0O1xuICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7fTtcbiAgICBpZiAocGFyYW1zLmVudGl0eVR5cGUpIHdoZXJlLmVudGl0eVR5cGUgPSBwYXJhbXMuZW50aXR5VHlwZTtcbiAgICBpZiAocGFyYW1zLmVudGl0eUlkKSB3aGVyZS5lbnRpdHlJZCA9IHBhcmFtcy5lbnRpdHlJZDtcbiAgICBjb25zdCBbdG90YWwsIHRhc2tzXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgIHRoaXMucHJpc21hLmJhY2tncm91bmRUYXNrLmNvdW50KHsgd2hlcmUgfSksXG4gICAgICB0aGlzLnByaXNtYS5iYWNrZ3JvdW5kVGFzay5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlLFxuICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICAgIHNraXAsXG4gICAgICAgIHRha2U6IGxpbWl0LFxuICAgICAgICBpbmNsdWRlOiB7IHN1YnRhc2tzOiB0cnVlIH1cbiAgICAgIH0pXG4gICAgXSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGRhdGE6IHRhc2tzLFxuICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICBwYWdlLFxuICAgICAgICBsaW1pdCxcbiAgICAgICAgdG90YWwsXG4gICAgICAgIHRvdGFsUGFnZXM6IE1hdGguY2VpbCh0b3RhbCAvIGxpbWl0KVxuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdldFN1YnRhc2tJZCh0YXNrSWQ6IHN0cmluZywgc3RlcEluZGV4OiBudW1iZXIpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IHN1YnRhc2sgPSBhd2FpdCB0aGlzLnByaXNtYS5iYWNrZ3JvdW5kVGFzay5maW5kRmlyc3QoeyB3aGVyZTogeyBwYXJlbnRUYXNrSWQ6IHRhc2tJZCwgc3RlcEluZGV4IH0gfSk7XG4gICAgaWYgKCFzdWJ0YXNrKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFN1YnRhc2sgbm90IGZvdW5kIGZvciB0YXNrICR7dGFza0lkfSBhdCBzdGVwICR7c3RlcEluZGV4fWApO1xuICAgIH1cbiAgICByZXR1cm4gc3VidGFzay5pZDtcbiAgfVxufVxuXG5cbiJdLCJuYW1lcyI6WyJUYXNrU3RhdHVzIiwibG9nZ2VyIiwiQmFja2dyb3VuZFRhc2tNYW5hZ2VyIiwiY29uc3RydWN0b3IiLCJwcmlzbWEiLCJjcmVhdGVUYXNrIiwicGFyYW1zIiwibmFtZSIsImRlc2NyaXB0aW9uIiwiZW50aXR5VHlwZSIsImVudGl0eUlkIiwic3VidGFza05hbWVzIiwicGFyZW50VGFzayIsImJhY2tncm91bmRUYXNrIiwiY3JlYXRlIiwiZGF0YSIsInN0YXR1cyIsIlBFTkRJTkciLCJwcm9ncmVzcyIsImxlbmd0aCIsImNyZWF0ZU1hbnkiLCJtYXAiLCJzdWJ0YXNrTmFtZSIsImluZGV4IiwicGFyZW50VGFza0lkIiwiaWQiLCJzdGVwSW5kZXgiLCJmdWxsVGFzayIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImluY2x1ZGUiLCJzdWJ0YXNrcyIsImluZm8iLCJ0YXNrSWQiLCJlcnJvciIsIm1hcmtUYXNrUnVubmluZyIsInVwZGF0ZSIsIlJVTk5JTkciLCJzdGFydGVkQXQiLCJEYXRlIiwidXBkYXRlVGFza1Byb2dyZXNzIiwibWFya1Rhc2tDb21wbGV0ZWQiLCJyZXN1bHQiLCJDT01QTEVURUQiLCJmaW5pc2hlZEF0IiwibWFya1Rhc2tGYWlsZWQiLCJlcnJvck1lc3NhZ2UiLCJGQUlMRUQiLCJtYXJrU3VidGFza1J1bm5pbmciLCJzdWJ0YXNrSWQiLCJnZXRTdWJ0YXNrSWQiLCJzdWJ0YXNrIiwidXBkYXRlU3VidGFza1Byb2dyZXNzIiwibWFya1N1YnRhc2tDb21wbGV0ZWQiLCJtYXJrU3VidGFza0ZhaWxlZCIsImdldFRhc2siLCJsaXN0VGFza3MiLCJwYWdlIiwibGltaXQiLCJza2lwIiwidG90YWwiLCJ0YXNrcyIsIlByb21pc2UiLCJhbGwiLCJjb3VudCIsImZpbmRNYW55Iiwib3JkZXJCeSIsImNyZWF0ZWRBdCIsInRha2UiLCJwYWdpbmF0aW9uIiwidG90YWxQYWdlcyIsIk1hdGgiLCJjZWlsIiwiZmluZEZpcnN0IiwiRXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/managers/backgroundTaskManager.ts\n");

/***/ }),

/***/ "(api)/./src/middleware/authMiddleware.ts":
/*!******************************************!*\
  !*** ./src/middleware/authMiddleware.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   withAuth: () => (/* binding */ withAuth)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _models_prismaClient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../models/prismaClient */ \"(api)/./src/models/prismaClient.ts\");\n/* harmony import */ var _utils_logger__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/logger */ \"(api)/./src/utils/logger.ts\");\n\n\n\n// Helper function to determine effective role based on OIDC groups\nfunction getEffectiveRole(userRole, authentikGroups) {\n    // If user has tech-team group, elevate to admin regardless of base role\n    if (authentikGroups.includes(\"tech-team\")) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info(\"User has tech-team group, elevating to admin role\", {\n            originalRole: userRole,\n            authentikGroups\n        });\n        return \"ADMIN\";\n    }\n    return userRole;\n}\nfunction withAuth(handler) {\n    return async (req, res)=>{\n        try {\n            // Get JWT token from Authorization header\n            const authHeader = req.headers.authorization;\n            if (!authHeader || !authHeader.startsWith(\"Bearer \")) {\n                _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn(\"No valid authorization header\", {\n                    path: req.url\n                });\n                return res.status(401).json({\n                    error: \"Unauthorized\",\n                    message: \"No valid token provided\"\n                });\n            }\n            const token = authHeader.substring(7); // Remove 'Bearer ' prefix\n            // Verify JWT token\n            let decoded;\n            try {\n                decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, process.env.JWT_SECRET || \"fallback-secret\");\n            } catch (error) {\n                _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn(\"Invalid JWT token\", {\n                    error,\n                    path: req.url\n                });\n                return res.status(401).json({\n                    error: \"Unauthorized\",\n                    message: \"Invalid token\"\n                });\n            }\n            if (!decoded || !decoded.id) {\n                _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn(\"Invalid token payload\", {\n                    path: req.url\n                });\n                return res.status(401).json({\n                    error: \"Unauthorized\",\n                    message: \"Invalid token payload\"\n                });\n            }\n            // Get fresh user data from database\n            const user = await _models_prismaClient__WEBPACK_IMPORTED_MODULE_1__.prisma.user.findUnique({\n                where: {\n                    id: decoded.id\n                },\n                select: {\n                    id: true,\n                    email: true,\n                    username: true,\n                    firstName: true,\n                    lastName: true,\n                    role: true\n                }\n            });\n            if (!user) {\n                _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.warn(\"User not found\", {\n                    userId: decoded.id,\n                    path: req.url\n                });\n                return res.status(401).json({\n                    error: \"Unauthorized\",\n                    message: \"User not found\"\n                });\n            }\n            // Get user groups\n            const userGroups = await _models_prismaClient__WEBPACK_IMPORTED_MODULE_1__.prisma.userGroup.findMany({\n                where: {\n                    userId: user.id\n                },\n                include: {\n                    group: {\n                        select: {\n                            name: true\n                        }\n                    }\n                }\n            });\n            // Create authenticated request with user info\n            const authenticatedReq = req;\n            authenticatedReq.user = {\n                id: user.id,\n                email: user.email,\n                username: user.username || undefined,\n                firstName: user.firstName,\n                lastName: user.lastName,\n                role: getEffectiveRole(user.role, userGroups.map((ug)=>ug.group.name)),\n                groups: userGroups.map((ug)=>ug.group.name)\n            };\n            _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info(\"Authentication successful\", {\n                userId: user.id,\n                userRole: authenticatedReq.user.role,\n                path: req.url\n            });\n            // Call the original handler\n            await handler(authenticatedReq, res);\n        } catch (error) {\n            _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Authentication middleware error\", {\n                error,\n                path: req.url\n            });\n            return res.status(500).json({\n                error: \"Internal server error\",\n                message: \"Authentication failed\"\n            });\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvbWlkZGxld2FyZS9hdXRoTWlkZGxld2FyZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUMrQjtBQUNpQjtBQUNQO0FBY3pDLG1FQUFtRTtBQUNuRSxTQUFTRyxpQkFBaUJDLFFBQWdCLEVBQUVDLGVBQXlCO0lBQ25FLHdFQUF3RTtJQUN4RSxJQUFJQSxnQkFBZ0JDLFFBQVEsQ0FBQyxjQUFjO1FBQ3pDSixpREFBTUEsQ0FBQ0ssSUFBSSxDQUFDLHFEQUFxRDtZQUMvREMsY0FBY0o7WUFDZEM7UUFDRjtRQUNBLE9BQU87SUFDVDtJQUNBLE9BQU9EO0FBQ1Q7QUFFTyxTQUFTSyxTQUFTQyxPQUEyRTtJQUNsRyxPQUFPLE9BQU9DLEtBQXFCQztRQUNqQyxJQUFJO1lBQ0YsMENBQTBDO1lBQzFDLE1BQU1DLGFBQWFGLElBQUlHLE9BQU8sQ0FBQ0MsYUFBYTtZQUM1QyxJQUFJLENBQUNGLGNBQWMsQ0FBQ0EsV0FBV0csVUFBVSxDQUFDLFlBQVk7Z0JBQ3BEZCxpREFBTUEsQ0FBQ2UsSUFBSSxDQUFDLGlDQUFpQztvQkFBRUMsTUFBTVAsSUFBSVEsR0FBRztnQkFBQztnQkFDN0QsT0FBT1AsSUFBSVEsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFDMUJDLE9BQU87b0JBQ1BDLFNBQVM7Z0JBQ1g7WUFDRjtZQUVBLE1BQU1DLFFBQVFYLFdBQVdZLFNBQVMsQ0FBQyxJQUFJLDBCQUEwQjtZQUVqRSxtQkFBbUI7WUFDbkIsSUFBSUM7WUFDSixJQUFJO2dCQUNGQSxVQUFVMUIsMERBQVUsQ0FBQ3dCLE9BQU9JLFFBQVFDLEdBQUcsQ0FBQ0MsVUFBVSxJQUFJO1lBQ3hELEVBQUUsT0FBT1IsT0FBTztnQkFDZHBCLGlEQUFNQSxDQUFDZSxJQUFJLENBQUMscUJBQXFCO29CQUFFSztvQkFBT0osTUFBTVAsSUFBSVEsR0FBRztnQkFBQztnQkFDeEQsT0FBT1AsSUFBSVEsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFDMUJDLE9BQU87b0JBQ1BDLFNBQVM7Z0JBQ1g7WUFDRjtZQUVBLElBQUksQ0FBQ0csV0FBVyxDQUFDQSxRQUFRSyxFQUFFLEVBQUU7Z0JBQzNCN0IsaURBQU1BLENBQUNlLElBQUksQ0FBQyx5QkFBeUI7b0JBQUVDLE1BQU1QLElBQUlRLEdBQUc7Z0JBQUM7Z0JBQ3JELE9BQU9QLElBQUlRLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7b0JBQzFCQyxPQUFPO29CQUNQQyxTQUFTO2dCQUNYO1lBQ0Y7WUFFQSxvQ0FBb0M7WUFDcEMsTUFBTVMsT0FBTyxNQUFNL0Isd0RBQU1BLENBQUMrQixJQUFJLENBQUNDLFVBQVUsQ0FBQztnQkFDeENDLE9BQU87b0JBQUVILElBQUlMLFFBQVFLLEVBQUU7Z0JBQUM7Z0JBQ3hCSSxRQUFRO29CQUNOSixJQUFJO29CQUNKSyxPQUFPO29CQUNQQyxVQUFVO29CQUNWQyxXQUFXO29CQUNYQyxVQUFVO29CQUNWQyxNQUFNO2dCQUNSO1lBQ0Y7WUFFQSxJQUFJLENBQUNSLE1BQU07Z0JBQ1Q5QixpREFBTUEsQ0FBQ2UsSUFBSSxDQUFDLGtCQUFrQjtvQkFBRXdCLFFBQVFmLFFBQVFLLEVBQUU7b0JBQUViLE1BQU1QLElBQUlRLEdBQUc7Z0JBQUM7Z0JBQ2xFLE9BQU9QLElBQUlRLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7b0JBQzFCQyxPQUFPO29CQUNQQyxTQUFTO2dCQUNYO1lBQ0Y7WUFFQSxrQkFBa0I7WUFDbEIsTUFBTW1CLGFBQWEsTUFBTXpDLHdEQUFNQSxDQUFDMEMsU0FBUyxDQUFDQyxRQUFRLENBQUM7Z0JBQ2pEVixPQUFPO29CQUFFTyxRQUFRVCxLQUFLRCxFQUFFO2dCQUFDO2dCQUN6QmMsU0FBUztvQkFDUEMsT0FBTzt3QkFDTFgsUUFBUTs0QkFDTlksTUFBTTt3QkFDUjtvQkFDRjtnQkFDRjtZQUNGO1lBRUEsOENBQThDO1lBQzlDLE1BQU1DLG1CQUFtQnJDO1lBQ3pCcUMsaUJBQWlCaEIsSUFBSSxHQUFHO2dCQUN0QkQsSUFBSUMsS0FBS0QsRUFBRTtnQkFDWEssT0FBT0osS0FBS0ksS0FBSztnQkFDakJDLFVBQVVMLEtBQUtLLFFBQVEsSUFBSVk7Z0JBQzNCWCxXQUFXTixLQUFLTSxTQUFTO2dCQUN6QkMsVUFBVVAsS0FBS08sUUFBUTtnQkFDdkJDLE1BQU1yQyxpQkFBaUI2QixLQUFLUSxJQUFJLEVBQUVFLFdBQVdRLEdBQUcsQ0FBQ0MsQ0FBQUEsS0FBTUEsR0FBR0wsS0FBSyxDQUFDQyxJQUFJO2dCQUNwRUssUUFBUVYsV0FBV1EsR0FBRyxDQUFDQyxDQUFBQSxLQUFNQSxHQUFHTCxLQUFLLENBQUNDLElBQUk7WUFDNUM7WUFFQTdDLGlEQUFNQSxDQUFDSyxJQUFJLENBQUMsNkJBQTZCO2dCQUN2Q2tDLFFBQVFULEtBQUtELEVBQUU7Z0JBQ2YzQixVQUFVNEMsaUJBQWlCaEIsSUFBSSxDQUFDUSxJQUFJO2dCQUNwQ3RCLE1BQU1QLElBQUlRLEdBQUc7WUFDZjtZQUVBLDRCQUE0QjtZQUM1QixNQUFNVCxRQUFRc0Msa0JBQWtCcEM7UUFDbEMsRUFBRSxPQUFPVSxPQUFPO1lBQ2RwQixpREFBTUEsQ0FBQ29CLEtBQUssQ0FBQyxtQ0FBbUM7Z0JBQUVBO2dCQUFPSixNQUFNUCxJQUFJUSxHQUFHO1lBQUM7WUFDdkUsT0FBT1AsSUFBSVEsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFDMUJDLE9BQU87Z0JBQ1BDLFNBQVM7WUFDWDtRQUNGO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL21ybTM2MC1iYWNrZW5kLy4vc3JjL21pZGRsZXdhcmUvYXV0aE1pZGRsZXdhcmUudHM/Mjg0ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XG5pbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbic7XG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuLi9tb2RlbHMvcHJpc21hQ2xpZW50JztcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJy4uL3V0aWxzL2xvZ2dlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXV0aGVudGljYXRlZFJlcXVlc3QgZXh0ZW5kcyBOZXh0QXBpUmVxdWVzdCB7XG4gIHVzZXI6IHtcbiAgICBpZDogc3RyaW5nO1xuICAgIGVtYWlsOiBzdHJpbmc7XG4gICAgdXNlcm5hbWU/OiBzdHJpbmc7XG4gICAgZmlyc3ROYW1lOiBzdHJpbmc7XG4gICAgbGFzdE5hbWU6IHN0cmluZztcbiAgICByb2xlOiBzdHJpbmc7XG4gICAgZ3JvdXBzOiBzdHJpbmdbXTtcbiAgfTtcbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGRldGVybWluZSBlZmZlY3RpdmUgcm9sZSBiYXNlZCBvbiBPSURDIGdyb3Vwc1xuZnVuY3Rpb24gZ2V0RWZmZWN0aXZlUm9sZSh1c2VyUm9sZTogc3RyaW5nLCBhdXRoZW50aWtHcm91cHM6IHN0cmluZ1tdKTogc3RyaW5nIHtcbiAgLy8gSWYgdXNlciBoYXMgdGVjaC10ZWFtIGdyb3VwLCBlbGV2YXRlIHRvIGFkbWluIHJlZ2FyZGxlc3Mgb2YgYmFzZSByb2xlXG4gIGlmIChhdXRoZW50aWtHcm91cHMuaW5jbHVkZXMoJ3RlY2gtdGVhbScpKSB7XG4gICAgbG9nZ2VyLmluZm8oJ1VzZXIgaGFzIHRlY2gtdGVhbSBncm91cCwgZWxldmF0aW5nIHRvIGFkbWluIHJvbGUnLCB7XG4gICAgICBvcmlnaW5hbFJvbGU6IHVzZXJSb2xlLFxuICAgICAgYXV0aGVudGlrR3JvdXBzXG4gICAgfSk7XG4gICAgcmV0dXJuICdBRE1JTic7XG4gIH1cbiAgcmV0dXJuIHVzZXJSb2xlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gd2l0aEF1dGgoaGFuZGxlcjogKHJlcTogQXV0aGVudGljYXRlZFJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSA9PiBQcm9taXNlPHZvaWQ+KSB7XG4gIHJldHVybiBhc3luYyAocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpID0+IHtcbiAgICB0cnkge1xuICAgICAgLy8gR2V0IEpXVCB0b2tlbiBmcm9tIEF1dGhvcml6YXRpb24gaGVhZGVyXG4gICAgICBjb25zdCBhdXRoSGVhZGVyID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbjtcbiAgICAgIGlmICghYXV0aEhlYWRlciB8fCAhYXV0aEhlYWRlci5zdGFydHNXaXRoKCdCZWFyZXIgJykpIHtcbiAgICAgICAgbG9nZ2VyLndhcm4oJ05vIHZhbGlkIGF1dGhvcml6YXRpb24gaGVhZGVyJywgeyBwYXRoOiByZXEudXJsIH0pO1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBcbiAgICAgICAgICBlcnJvcjogJ1VuYXV0aG9yaXplZCcsXG4gICAgICAgICAgbWVzc2FnZTogJ05vIHZhbGlkIHRva2VuIHByb3ZpZGVkJyBcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRva2VuID0gYXV0aEhlYWRlci5zdWJzdHJpbmcoNyk7IC8vIFJlbW92ZSAnQmVhcmVyICcgcHJlZml4XG5cbiAgICAgIC8vIFZlcmlmeSBKV1QgdG9rZW5cbiAgICAgIGxldCBkZWNvZGVkOiBhbnk7XG4gICAgICB0cnkge1xuICAgICAgICBkZWNvZGVkID0gand0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCAnZmFsbGJhY2stc2VjcmV0Jyk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2dnZXIud2FybignSW52YWxpZCBKV1QgdG9rZW4nLCB7IGVycm9yLCBwYXRoOiByZXEudXJsIH0pO1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBcbiAgICAgICAgICBlcnJvcjogJ1VuYXV0aG9yaXplZCcsXG4gICAgICAgICAgbWVzc2FnZTogJ0ludmFsaWQgdG9rZW4nIFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFkZWNvZGVkIHx8ICFkZWNvZGVkLmlkKSB7XG4gICAgICAgIGxvZ2dlci53YXJuKCdJbnZhbGlkIHRva2VuIHBheWxvYWQnLCB7IHBhdGg6IHJlcS51cmwgfSk7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IFxuICAgICAgICAgIGVycm9yOiAnVW5hdXRob3JpemVkJyxcbiAgICAgICAgICBtZXNzYWdlOiAnSW52YWxpZCB0b2tlbiBwYXlsb2FkJyBcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEdldCBmcmVzaCB1c2VyIGRhdGEgZnJvbSBkYXRhYmFzZVxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBpZDogZGVjb2RlZC5pZCB9LFxuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICBlbWFpbDogdHJ1ZSxcbiAgICAgICAgICB1c2VybmFtZTogdHJ1ZSxcbiAgICAgICAgICBmaXJzdE5hbWU6IHRydWUsXG4gICAgICAgICAgbGFzdE5hbWU6IHRydWUsXG4gICAgICAgICAgcm9sZTogdHJ1ZVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIGxvZ2dlci53YXJuKCdVc2VyIG5vdCBmb3VuZCcsIHsgdXNlcklkOiBkZWNvZGVkLmlkLCBwYXRoOiByZXEudXJsIH0pO1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBcbiAgICAgICAgICBlcnJvcjogJ1VuYXV0aG9yaXplZCcsXG4gICAgICAgICAgbWVzc2FnZTogJ1VzZXIgbm90IGZvdW5kJyBcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEdldCB1c2VyIGdyb3Vwc1xuICAgICAgY29uc3QgdXNlckdyb3VwcyA9IGF3YWl0IHByaXNtYS51c2VyR3JvdXAuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogeyB1c2VySWQ6IHVzZXIuaWQgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIGdyb3VwOiB7XG4gICAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgICAgbmFtZTogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIENyZWF0ZSBhdXRoZW50aWNhdGVkIHJlcXVlc3Qgd2l0aCB1c2VyIGluZm9cbiAgICAgIGNvbnN0IGF1dGhlbnRpY2F0ZWRSZXEgPSByZXEgYXMgQXV0aGVudGljYXRlZFJlcXVlc3Q7XG4gICAgICBhdXRoZW50aWNhdGVkUmVxLnVzZXIgPSB7XG4gICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgdXNlcm5hbWU6IHVzZXIudXNlcm5hbWUgfHwgdW5kZWZpbmVkLFxuICAgICAgICBmaXJzdE5hbWU6IHVzZXIuZmlyc3ROYW1lLFxuICAgICAgICBsYXN0TmFtZTogdXNlci5sYXN0TmFtZSxcbiAgICAgICAgcm9sZTogZ2V0RWZmZWN0aXZlUm9sZSh1c2VyLnJvbGUsIHVzZXJHcm91cHMubWFwKHVnID0+IHVnLmdyb3VwLm5hbWUpKSxcbiAgICAgICAgZ3JvdXBzOiB1c2VyR3JvdXBzLm1hcCh1ZyA9PiB1Zy5ncm91cC5uYW1lKVxuICAgICAgfTtcblxuICAgICAgbG9nZ2VyLmluZm8oJ0F1dGhlbnRpY2F0aW9uIHN1Y2Nlc3NmdWwnLCB7IFxuICAgICAgICB1c2VySWQ6IHVzZXIuaWQsIFxuICAgICAgICB1c2VyUm9sZTogYXV0aGVudGljYXRlZFJlcS51c2VyLnJvbGUsXG4gICAgICAgIHBhdGg6IHJlcS51cmwgXG4gICAgICB9KTtcblxuICAgICAgLy8gQ2FsbCB0aGUgb3JpZ2luYWwgaGFuZGxlclxuICAgICAgYXdhaXQgaGFuZGxlcihhdXRoZW50aWNhdGVkUmVxLCByZXMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0F1dGhlbnRpY2F0aW9uIG1pZGRsZXdhcmUgZXJyb3InLCB7IGVycm9yLCBwYXRoOiByZXEudXJsIH0pO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICAgIGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyxcbiAgICAgICAgbWVzc2FnZTogJ0F1dGhlbnRpY2F0aW9uIGZhaWxlZCcgXG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59XG4iXSwibmFtZXMiOlsiand0IiwicHJpc21hIiwibG9nZ2VyIiwiZ2V0RWZmZWN0aXZlUm9sZSIsInVzZXJSb2xlIiwiYXV0aGVudGlrR3JvdXBzIiwiaW5jbHVkZXMiLCJpbmZvIiwib3JpZ2luYWxSb2xlIiwid2l0aEF1dGgiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwiYXV0aEhlYWRlciIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwic3RhcnRzV2l0aCIsIndhcm4iLCJwYXRoIiwidXJsIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwibWVzc2FnZSIsInRva2VuIiwic3Vic3RyaW5nIiwiZGVjb2RlZCIsInZlcmlmeSIsInByb2Nlc3MiLCJlbnYiLCJKV1RfU0VDUkVUIiwiaWQiLCJ1c2VyIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwic2VsZWN0IiwiZW1haWwiLCJ1c2VybmFtZSIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwicm9sZSIsInVzZXJJZCIsInVzZXJHcm91cHMiLCJ1c2VyR3JvdXAiLCJmaW5kTWFueSIsImluY2x1ZGUiLCJncm91cCIsIm5hbWUiLCJhdXRoZW50aWNhdGVkUmVxIiwidW5kZWZpbmVkIiwibWFwIiwidWciLCJncm91cHMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/middleware/authMiddleware.ts\n");

/***/ }),

/***/ "(api)/./src/middleware/corsMiddleware.ts":
/*!******************************************!*\
  !*** ./src/middleware/corsMiddleware.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   withCORS: () => (/* binding */ withCORS)\n/* harmony export */ });\nfunction withCORS(handler) {\n    return async (req, res)=>{\n        // Set CORS headers\n        const allowedOrigin = process.env.FRONTEND_URL || \"http://localhost:3011\";\n        res.setHeader(\"Access-Control-Allow-Credentials\", \"true\");\n        res.setHeader(\"Access-Control-Allow-Origin\", allowedOrigin);\n        res.setHeader(\"Access-Control-Allow-Methods\", \"GET,OPTIONS,PATCH,DELETE,POST,PUT\");\n        res.setHeader(\"Access-Control-Allow-Headers\", \"X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version, Authorization\");\n        // Handle preflight request\n        if (req.method === \"OPTIONS\") {\n            res.status(200).end();\n            return;\n        }\n        // Call the original handler\n        await handler(req, res);\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvbWlkZGxld2FyZS9jb3JzTWlkZGxld2FyZS50cyIsIm1hcHBpbmdzIjoiOzs7O0FBRU8sU0FBU0EsU0FBU0MsT0FBcUU7SUFDNUYsT0FBTyxPQUFPQyxLQUFxQkM7UUFDakMsbUJBQW1CO1FBQ25CLE1BQU1DLGdCQUFnQkMsUUFBUUMsR0FBRyxDQUFDQyxZQUFZLElBQUk7UUFFbERKLElBQUlLLFNBQVMsQ0FBQyxvQ0FBb0M7UUFDbERMLElBQUlLLFNBQVMsQ0FBQywrQkFBK0JKO1FBQzdDRCxJQUFJSyxTQUFTLENBQUMsZ0NBQWdDO1FBQzlDTCxJQUFJSyxTQUFTLENBQUMsZ0NBQWdDO1FBRTlDLDJCQUEyQjtRQUMzQixJQUFJTixJQUFJTyxNQUFNLEtBQUssV0FBVztZQUM1Qk4sSUFBSU8sTUFBTSxDQUFDLEtBQUtDLEdBQUc7WUFDbkI7UUFDRjtRQUVBLDRCQUE0QjtRQUM1QixNQUFNVixRQUFRQyxLQUFLQztJQUNyQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXJtMzYwLWJhY2tlbmQvLi9zcmMvbWlkZGxld2FyZS9jb3JzTWlkZGxld2FyZS50cz8zYjljIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcblxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhDT1JTKGhhbmRsZXI6IChyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkgPT4gUHJvbWlzZTx2b2lkPikge1xuICByZXR1cm4gYXN5bmMgKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSA9PiB7XG4gICAgLy8gU2V0IENPUlMgaGVhZGVyc1xuICAgIGNvbnN0IGFsbG93ZWRPcmlnaW4gPSBwcm9jZXNzLmVudi5GUk9OVEVORF9VUkwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAxMSc7XG4gICAgXG4gICAgcmVzLnNldEhlYWRlcignQWNjZXNzLUNvbnRyb2wtQWxsb3ctQ3JlZGVudGlhbHMnLCAndHJ1ZScpO1xuICAgIHJlcy5zZXRIZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbicsIGFsbG93ZWRPcmlnaW4pO1xuICAgIHJlcy5zZXRIZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnLCAnR0VULE9QVElPTlMsUEFUQ0gsREVMRVRFLFBPU1QsUFVUJyk7XG4gICAgcmVzLnNldEhlYWRlcignQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVycycsICdYLUNTUkYtVG9rZW4sIFgtUmVxdWVzdGVkLVdpdGgsIEFjY2VwdCwgQWNjZXB0LVZlcnNpb24sIENvbnRlbnQtTGVuZ3RoLCBDb250ZW50LU1ENSwgQ29udGVudC1UeXBlLCBEYXRlLCBYLUFwaS1WZXJzaW9uLCBBdXRob3JpemF0aW9uJyk7XG5cbiAgICAvLyBIYW5kbGUgcHJlZmxpZ2h0IHJlcXVlc3RcbiAgICBpZiAocmVxLm1ldGhvZCA9PT0gJ09QVElPTlMnKSB7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuZW5kKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQ2FsbCB0aGUgb3JpZ2luYWwgaGFuZGxlclxuICAgIGF3YWl0IGhhbmRsZXIocmVxLCByZXMpO1xuICB9O1xufVxuIl0sIm5hbWVzIjpbIndpdGhDT1JTIiwiaGFuZGxlciIsInJlcSIsInJlcyIsImFsbG93ZWRPcmlnaW4iLCJwcm9jZXNzIiwiZW52IiwiRlJPTlRFTkRfVVJMIiwic2V0SGVhZGVyIiwibWV0aG9kIiwic3RhdHVzIiwiZW5kIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/middleware/corsMiddleware.ts\n");

/***/ }),

/***/ "(api)/./src/middleware/errorHandler.ts":
/*!****************************************!*\
  !*** ./src/middleware/errorHandler.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Errors: () => (/* binding */ Errors),\n/* harmony export */   createError: () => (/* binding */ createError),\n/* harmony export */   handleApiError: () => (/* binding */ handleApiError),\n/* harmony export */   withErrorHandler: () => (/* binding */ withErrorHandler)\n/* harmony export */ });\nfunction createError(message, statusCode = 500, code) {\n    const error = new Error(message);\n    error.statusCode = statusCode;\n    error.code = code;\n    return error;\n}\nfunction handleApiError(error, req, res) {\n    console.error(\"API Error:\", {\n        error,\n        url: req.url,\n        method: req.method,\n        timestamp: new Date().toISOString()\n    });\n    if (error instanceof Error) {\n        const apiError = error;\n        if (apiError.statusCode) {\n            return res.status(apiError.statusCode).json({\n                success: false,\n                error: apiError.message,\n                code: apiError.code\n            });\n        }\n    }\n    // Default error response\n    return res.status(500).json({\n        success: false,\n        error: \"Internal server error\"\n    });\n}\nfunction withErrorHandler(handler) {\n    return async (req, res)=>{\n        try {\n            await handler(req, res);\n        } catch (error) {\n            handleApiError(error, req, res);\n        }\n    };\n}\n// Common error types\nconst Errors = {\n    NOT_FOUND: (resource)=>createError(`${resource} not found`, 404, \"NOT_FOUND\"),\n    UNAUTHORIZED: ()=>createError(\"Unauthorized\", 401, \"UNAUTHORIZED\"),\n    FORBIDDEN: ()=>createError(\"Forbidden\", 403, \"FORBIDDEN\"),\n    BAD_REQUEST: (message)=>createError(message, 400, \"BAD_REQUEST\"),\n    VALIDATION_ERROR: (message)=>createError(message, 400, \"VALIDATION_ERROR\"),\n    CONFLICT: (message)=>createError(message, 409, \"CONFLICT\"),\n    INTERNAL_ERROR: ()=>createError(\"Internal server error\", 500, \"INTERNAL_ERROR\")\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvbWlkZGxld2FyZS9lcnJvckhhbmRsZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQU9PLFNBQVNBLFlBQVlDLE9BQWUsRUFBRUMsYUFBcUIsR0FBRyxFQUFFQyxJQUFhO0lBQ2xGLE1BQU1DLFFBQVEsSUFBSUMsTUFBTUo7SUFDeEJHLE1BQU1GLFVBQVUsR0FBR0E7SUFDbkJFLE1BQU1ELElBQUksR0FBR0E7SUFDYixPQUFPQztBQUNUO0FBRU8sU0FBU0UsZUFDZEYsS0FBYyxFQUNkRyxHQUFtQixFQUNuQkMsR0FBb0I7SUFFcEJDLFFBQVFMLEtBQUssQ0FBQyxjQUFjO1FBQzFCQTtRQUNBTSxLQUFLSCxJQUFJRyxHQUFHO1FBQ1pDLFFBQVFKLElBQUlJLE1BQU07UUFDbEJDLFdBQVcsSUFBSUMsT0FBT0MsV0FBVztJQUNuQztJQUVBLElBQUlWLGlCQUFpQkMsT0FBTztRQUMxQixNQUFNVSxXQUFXWDtRQUVqQixJQUFJVyxTQUFTYixVQUFVLEVBQUU7WUFDdkIsT0FBT00sSUFBSVEsTUFBTSxDQUFDRCxTQUFTYixVQUFVLEVBQUVlLElBQUksQ0FBQztnQkFDMUNDLFNBQVM7Z0JBQ1RkLE9BQU9XLFNBQVNkLE9BQU87Z0JBQ3ZCRSxNQUFNWSxTQUFTWixJQUFJO1lBQ3JCO1FBQ0Y7SUFDRjtJQUVBLHlCQUF5QjtJQUN6QixPQUFPSyxJQUFJUSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1FBQzFCQyxTQUFTO1FBQ1RkLE9BQU87SUFDVDtBQUNGO0FBRU8sU0FBU2UsaUJBQ2RDLE9BQXFFO0lBRXJFLE9BQU8sT0FBT2IsS0FBcUJDO1FBQ2pDLElBQUk7WUFDRixNQUFNWSxRQUFRYixLQUFLQztRQUNyQixFQUFFLE9BQU9KLE9BQU87WUFDZEUsZUFBZUYsT0FBT0csS0FBS0M7UUFDN0I7SUFDRjtBQUNGO0FBRUEscUJBQXFCO0FBQ2QsTUFBTWEsU0FBUztJQUNwQkMsV0FBVyxDQUFDQyxXQUFxQnZCLFlBQVksQ0FBQyxFQUFFdUIsU0FBUyxVQUFVLENBQUMsRUFBRSxLQUFLO0lBQzNFQyxjQUFjLElBQU14QixZQUFZLGdCQUFnQixLQUFLO0lBQ3JEeUIsV0FBVyxJQUFNekIsWUFBWSxhQUFhLEtBQUs7SUFDL0MwQixhQUFhLENBQUN6QixVQUFvQkQsWUFBWUMsU0FBUyxLQUFLO0lBQzVEMEIsa0JBQWtCLENBQUMxQixVQUFvQkQsWUFBWUMsU0FBUyxLQUFLO0lBQ2pFMkIsVUFBVSxDQUFDM0IsVUFBb0JELFlBQVlDLFNBQVMsS0FBSztJQUN6RDRCLGdCQUFnQixJQUFNN0IsWUFBWSx5QkFBeUIsS0FBSztBQUNsRSxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXJtMzYwLWJhY2tlbmQvLi9zcmMvbWlkZGxld2FyZS9lcnJvckhhbmRsZXIudHM/N2E4OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEFwaUVycm9yIGV4dGVuZHMgRXJyb3Ige1xyXG4gIHN0YXR1c0NvZGU/OiBudW1iZXI7XHJcbiAgY29kZT86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUVycm9yKG1lc3NhZ2U6IHN0cmluZywgc3RhdHVzQ29kZTogbnVtYmVyID0gNTAwLCBjb2RlPzogc3RyaW5nKTogQXBpRXJyb3Ige1xyXG4gIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKG1lc3NhZ2UpIGFzIEFwaUVycm9yO1xyXG4gIGVycm9yLnN0YXR1c0NvZGUgPSBzdGF0dXNDb2RlO1xyXG4gIGVycm9yLmNvZGUgPSBjb2RlO1xyXG4gIHJldHVybiBlcnJvcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZUFwaUVycm9yKFxyXG4gIGVycm9yOiB1bmtub3duLFxyXG4gIHJlcTogTmV4dEFwaVJlcXVlc3QsXHJcbiAgcmVzOiBOZXh0QXBpUmVzcG9uc2VcclxuKSB7XHJcbiAgY29uc29sZS5lcnJvcignQVBJIEVycm9yOicsIHtcclxuICAgIGVycm9yLFxyXG4gICAgdXJsOiByZXEudXJsLFxyXG4gICAgbWV0aG9kOiByZXEubWV0aG9kLFxyXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICB9KTtcclxuXHJcbiAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcclxuICAgIGNvbnN0IGFwaUVycm9yID0gZXJyb3IgYXMgQXBpRXJyb3I7XHJcbiAgICBcclxuICAgIGlmIChhcGlFcnJvci5zdGF0dXNDb2RlKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKGFwaUVycm9yLnN0YXR1c0NvZGUpLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiBhcGlFcnJvci5tZXNzYWdlLFxyXG4gICAgICAgIGNvZGU6IGFwaUVycm9yLmNvZGVcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBEZWZhdWx0IGVycm9yIHJlc3BvbnNlXHJcbiAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InXHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB3aXRoRXJyb3JIYW5kbGVyKFxyXG4gIGhhbmRsZXI6IChyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkgPT4gUHJvbWlzZTx2b2lkPlxyXG4pIHtcclxuICByZXR1cm4gYXN5bmMgKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCBoYW5kbGVyKHJlcSwgcmVzKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGhhbmRsZUFwaUVycm9yKGVycm9yLCByZXEsIHJlcyk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5cclxuLy8gQ29tbW9uIGVycm9yIHR5cGVzXHJcbmV4cG9ydCBjb25zdCBFcnJvcnMgPSB7XHJcbiAgTk9UX0ZPVU5EOiAocmVzb3VyY2U6IHN0cmluZykgPT4gY3JlYXRlRXJyb3IoYCR7cmVzb3VyY2V9IG5vdCBmb3VuZGAsIDQwNCwgJ05PVF9GT1VORCcpLFxyXG4gIFVOQVVUSE9SSVpFRDogKCkgPT4gY3JlYXRlRXJyb3IoJ1VuYXV0aG9yaXplZCcsIDQwMSwgJ1VOQVVUSE9SSVpFRCcpLFxyXG4gIEZPUkJJRERFTjogKCkgPT4gY3JlYXRlRXJyb3IoJ0ZvcmJpZGRlbicsIDQwMywgJ0ZPUkJJRERFTicpLFxyXG4gIEJBRF9SRVFVRVNUOiAobWVzc2FnZTogc3RyaW5nKSA9PiBjcmVhdGVFcnJvcihtZXNzYWdlLCA0MDAsICdCQURfUkVRVUVTVCcpLFxyXG4gIFZBTElEQVRJT05fRVJST1I6IChtZXNzYWdlOiBzdHJpbmcpID0+IGNyZWF0ZUVycm9yKG1lc3NhZ2UsIDQwMCwgJ1ZBTElEQVRJT05fRVJST1InKSxcclxuICBDT05GTElDVDogKG1lc3NhZ2U6IHN0cmluZykgPT4gY3JlYXRlRXJyb3IobWVzc2FnZSwgNDA5LCAnQ09ORkxJQ1QnKSxcclxuICBJTlRFUk5BTF9FUlJPUjogKCkgPT4gY3JlYXRlRXJyb3IoJ0ludGVybmFsIHNlcnZlciBlcnJvcicsIDUwMCwgJ0lOVEVSTkFMX0VSUk9SJylcclxufTtcclxuIl0sIm5hbWVzIjpbImNyZWF0ZUVycm9yIiwibWVzc2FnZSIsInN0YXR1c0NvZGUiLCJjb2RlIiwiZXJyb3IiLCJFcnJvciIsImhhbmRsZUFwaUVycm9yIiwicmVxIiwicmVzIiwiY29uc29sZSIsInVybCIsIm1ldGhvZCIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImFwaUVycm9yIiwic3RhdHVzIiwianNvbiIsInN1Y2Nlc3MiLCJ3aXRoRXJyb3JIYW5kbGVyIiwiaGFuZGxlciIsIkVycm9ycyIsIk5PVF9GT1VORCIsInJlc291cmNlIiwiVU5BVVRIT1JJWkVEIiwiRk9SQklEREVOIiwiQkFEX1JFUVVFU1QiLCJWQUxJREFUSU9OX0VSUk9SIiwiQ09ORkxJQ1QiLCJJTlRFUk5BTF9FUlJPUiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/middleware/errorHandler.ts\n");

/***/ }),

/***/ "(api)/./src/middleware/permissionMiddleware.ts":
/*!************************************************!*\
  !*** ./src/middleware/permissionMiddleware.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   withPermissions: () => (/* binding */ withPermissions)\n/* harmony export */ });\n/* harmony import */ var _utils_logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/logger */ \"(api)/./src/utils/logger.ts\");\n\nfunction withPermissions(handler, requiredPermissions) {\n    return async (req, res)=>{\n        try {\n            // Cast to PermissionRequest since this middleware should be used after withAuth\n            const permissionReq = req;\n            if (!permissionReq.user) {\n                _utils_logger__WEBPACK_IMPORTED_MODULE_0__.logger.warn(\"Permission check attempted without authentication\", {\n                    path: req.url,\n                    method: req.method\n                });\n                return res.status(401).json({\n                    error: \"Unauthorized\",\n                    message: \"Authentication required\"\n                });\n            }\n            // Get required permissions (either static array or dynamic function)\n            const permissions = typeof requiredPermissions === \"function\" ? requiredPermissions(req) : requiredPermissions;\n            // Check if user has required permissions\n            const hasPermission = await checkPermissions(permissionReq.user, permissions);\n            if (!hasPermission) {\n                _utils_logger__WEBPACK_IMPORTED_MODULE_0__.logger.warn(\"Insufficient permissions\", {\n                    userId: permissionReq.user.id,\n                    userRole: permissionReq.user.role,\n                    requiredPermissions: permissions,\n                    path: req.url\n                });\n                return res.status(403).json({\n                    error: \"Forbidden\",\n                    message: \"Insufficient permissions for this operation\"\n                });\n            }\n            _utils_logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"Permission check passed\", {\n                userId: permissionReq.user.id,\n                requiredPermissions: permissions,\n                path: req.url\n            });\n            // Call the original handler\n            await handler(permissionReq, res);\n        } catch (error) {\n            _utils_logger__WEBPACK_IMPORTED_MODULE_0__.logger.error(\"Permission middleware error\", {\n                error,\n                path: req.url\n            });\n            return res.status(500).json({\n                error: \"Internal server error\",\n                message: \"Permission check failed\"\n            });\n        }\n    };\n}\nasync function checkPermissions(user, requiredPermissions) {\n    // For now, implement a simple role-based permission system\n    // This can be enhanced later with a more sophisticated permission system\n    const rolePermissions = {\n        \"ADMIN\": [\n            \"users:read\",\n            \"users:create\",\n            \"users:update\",\n            \"users:delete\",\n            \"groups:read\",\n            \"groups:create\",\n            \"groups:update\",\n            \"groups:delete\",\n            \"events:read\",\n            \"events:create\",\n            \"events:update\",\n            \"events:delete\",\n            \"teams:read\",\n            \"teams:write\",\n            \"teams:create\",\n            \"teams:update\",\n            \"teams:delete\",\n            \"tasks:read\",\n            \"tasks:create\",\n            \"tasks:update\",\n            \"tasks:delete\",\n            \"tasks:enqueue\"\n        ],\n        \"EXEC_BOARD\": [\n            \"users:read\",\n            \"users:create\",\n            \"users:update\",\n            \"groups:read\",\n            \"groups:create\",\n            \"groups:update\",\n            \"events:read\",\n            \"events:create\",\n            \"events:update\",\n            \"teams:read\",\n            \"teams:write\",\n            \"teams:create\",\n            \"teams:update\",\n            \"tasks:read\",\n            \"tasks:create\",\n            \"tasks:update\"\n        ],\n        \"MEMBER\": [\n            \"users:read\",\n            \"groups:read\",\n            \"events:read\",\n            \"teams:read\",\n            \"tasks:read\"\n        ]\n    };\n    // Check if user has tech-team group in authentikGroups (OIDC groups)\n    // If they do, give them admin permissions regardless of their role\n    let effectiveRole = user.role;\n    if (user.authentikGroups && Array.isArray(user.authentikGroups)) {\n        if (user.authentikGroups.includes(\"tech-team\")) {\n            effectiveRole = \"ADMIN\";\n            _utils_logger__WEBPACK_IMPORTED_MODULE_0__.logger.info(\"User has tech-team group, elevating to admin permissions\", {\n                userId: user.id,\n                originalRole: user.role,\n                authentikGroups: user.authentikGroups\n            });\n        }\n    }\n    const userPermissions = rolePermissions[effectiveRole] || [];\n    // Check if user has all required permissions\n    return requiredPermissions.every((permission)=>userPermissions.includes(permission));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvbWlkZGxld2FyZS9wZXJtaXNzaW9uTWlkZGxld2FyZS50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUV5QztBQU1sQyxTQUFTQyxnQkFDZEMsT0FBd0UsRUFDeEVDLG1CQUFtRTtJQUVuRSxPQUFPLE9BQU9DLEtBQXFCQztRQUNqQyxJQUFJO1lBQ0YsZ0ZBQWdGO1lBQ2hGLE1BQU1DLGdCQUFnQkY7WUFFdEIsSUFBSSxDQUFDRSxjQUFjQyxJQUFJLEVBQUU7Z0JBQ3ZCUCxpREFBTUEsQ0FBQ1EsSUFBSSxDQUFDLHFEQUFxRDtvQkFDL0RDLE1BQU1MLElBQUlNLEdBQUc7b0JBQ2JDLFFBQVFQLElBQUlPLE1BQU07Z0JBQ3BCO2dCQUVBLE9BQU9OLElBQUlPLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7b0JBQzFCQyxPQUFPO29CQUNQQyxTQUFTO2dCQUNYO1lBQ0Y7WUFFQSxxRUFBcUU7WUFDckUsTUFBTUMsY0FBYyxPQUFPYix3QkFBd0IsYUFDL0NBLG9CQUFvQkMsT0FDcEJEO1lBRUoseUNBQXlDO1lBQ3pDLE1BQU1jLGdCQUFnQixNQUFNQyxpQkFBaUJaLGNBQWNDLElBQUksRUFBRVM7WUFFakUsSUFBSSxDQUFDQyxlQUFlO2dCQUNsQmpCLGlEQUFNQSxDQUFDUSxJQUFJLENBQUMsNEJBQTRCO29CQUN0Q1csUUFBUWIsY0FBY0MsSUFBSSxDQUFDYSxFQUFFO29CQUM3QkMsVUFBVWYsY0FBY0MsSUFBSSxDQUFDZSxJQUFJO29CQUNqQ25CLHFCQUFxQmE7b0JBQ3JCUCxNQUFNTCxJQUFJTSxHQUFHO2dCQUNmO2dCQUVBLE9BQU9MLElBQUlPLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7b0JBQzFCQyxPQUFPO29CQUNQQyxTQUFTO2dCQUNYO1lBQ0Y7WUFFQWYsaURBQU1BLENBQUN1QixJQUFJLENBQUMsMkJBQTJCO2dCQUNyQ0osUUFBUWIsY0FBY0MsSUFBSSxDQUFDYSxFQUFFO2dCQUM3QmpCLHFCQUFxQmE7Z0JBQ3JCUCxNQUFNTCxJQUFJTSxHQUFHO1lBQ2Y7WUFFQSw0QkFBNEI7WUFDNUIsTUFBTVIsUUFBUUksZUFBZUQ7UUFDL0IsRUFBRSxPQUFPUyxPQUFPO1lBQ2RkLGlEQUFNQSxDQUFDYyxLQUFLLENBQUMsK0JBQStCO2dCQUFFQTtnQkFBT0wsTUFBTUwsSUFBSU0sR0FBRztZQUFDO1lBQ25FLE9BQU9MLElBQUlPLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQzFCQyxPQUFPO2dCQUNQQyxTQUFTO1lBQ1g7UUFDRjtJQUNGO0FBQ0Y7QUFFQSxlQUFlRyxpQkFBaUJYLElBQVMsRUFBRUosbUJBQTZCO0lBQ3RFLDJEQUEyRDtJQUMzRCx5RUFBeUU7SUFFekUsTUFBTXFCLGtCQUE0QztRQUNoRCxTQUFTO1lBQ1A7WUFBYztZQUFnQjtZQUFnQjtZQUM5QztZQUFlO1lBQWlCO1lBQWlCO1lBQ2pEO1lBQWU7WUFBaUI7WUFBaUI7WUFDakQ7WUFBYztZQUFlO1lBQWdCO1lBQWdCO1lBQzdEO1lBQWM7WUFBZ0I7WUFBZ0I7WUFBZ0I7U0FDL0Q7UUFDRCxjQUFjO1lBQ1o7WUFBYztZQUFnQjtZQUM5QjtZQUFlO1lBQWlCO1lBQ2hDO1lBQWU7WUFBaUI7WUFDaEM7WUFBYztZQUFlO1lBQWdCO1lBQzdDO1lBQWM7WUFBZ0I7U0FDL0I7UUFDRCxVQUFVO1lBQ1I7WUFDQTtZQUNBO1lBQ0E7WUFDQTtTQUNEO0lBQ0g7SUFFQSxxRUFBcUU7SUFDckUsbUVBQW1FO0lBQ25FLElBQUlDLGdCQUFnQmxCLEtBQUtlLElBQUk7SUFDN0IsSUFBSWYsS0FBS21CLGVBQWUsSUFBSUMsTUFBTUMsT0FBTyxDQUFDckIsS0FBS21CLGVBQWUsR0FBRztRQUMvRCxJQUFJbkIsS0FBS21CLGVBQWUsQ0FBQ0csUUFBUSxDQUFDLGNBQWM7WUFDOUNKLGdCQUFnQjtZQUNoQnpCLGlEQUFNQSxDQUFDdUIsSUFBSSxDQUFDLDREQUE0RDtnQkFDdEVKLFFBQVFaLEtBQUthLEVBQUU7Z0JBQ2ZVLGNBQWN2QixLQUFLZSxJQUFJO2dCQUN2QkksaUJBQWlCbkIsS0FBS21CLGVBQWU7WUFDdkM7UUFDRjtJQUNGO0lBRUEsTUFBTUssa0JBQWtCUCxlQUFlLENBQUNDLGNBQWMsSUFBSSxFQUFFO0lBRTVELDZDQUE2QztJQUM3QyxPQUFPdEIsb0JBQW9CNkIsS0FBSyxDQUFDQyxDQUFBQSxhQUFjRixnQkFBZ0JGLFFBQVEsQ0FBQ0k7QUFDMUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tcm0zNjAtYmFja2VuZC8uL3NyYy9taWRkbGV3YXJlL3Blcm1pc3Npb25NaWRkbGV3YXJlLnRzP2Y4MTQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IHsgQXV0aGVudGljYXRlZFJlcXVlc3QgfSBmcm9tICcuL2F1dGhNaWRkbGV3YXJlJztcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJy4uL3V0aWxzL2xvZ2dlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGVybWlzc2lvblJlcXVlc3QgZXh0ZW5kcyBBdXRoZW50aWNhdGVkUmVxdWVzdCB7XG4gIC8vIEV4dGVuZHMgQXV0aGVudGljYXRlZFJlcXVlc3Qgd2l0aCB1c2VyIGluZm9cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhQZXJtaXNzaW9ucyhcbiAgaGFuZGxlcjogKHJlcTogUGVybWlzc2lvblJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSA9PiBQcm9taXNlPHZvaWQ+LFxuICByZXF1aXJlZFBlcm1pc3Npb25zOiBzdHJpbmdbXSB8ICgocmVxOiBOZXh0QXBpUmVxdWVzdCkgPT4gc3RyaW5nW10pXG4pIHtcbiAgcmV0dXJuIGFzeW5jIChyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBDYXN0IHRvIFBlcm1pc3Npb25SZXF1ZXN0IHNpbmNlIHRoaXMgbWlkZGxld2FyZSBzaG91bGQgYmUgdXNlZCBhZnRlciB3aXRoQXV0aFxuICAgICAgY29uc3QgcGVybWlzc2lvblJlcSA9IHJlcSBhcyBQZXJtaXNzaW9uUmVxdWVzdDtcblxuICAgICAgaWYgKCFwZXJtaXNzaW9uUmVxLnVzZXIpIHtcbiAgICAgICAgbG9nZ2VyLndhcm4oJ1Blcm1pc3Npb24gY2hlY2sgYXR0ZW1wdGVkIHdpdGhvdXQgYXV0aGVudGljYXRpb24nLCB7IFxuICAgICAgICAgIHBhdGg6IHJlcS51cmwsIFxuICAgICAgICAgIG1ldGhvZDogcmVxLm1ldGhvZCBcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBcbiAgICAgICAgICBlcnJvcjogJ1VuYXV0aG9yaXplZCcsXG4gICAgICAgICAgbWVzc2FnZTogJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJyBcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEdldCByZXF1aXJlZCBwZXJtaXNzaW9ucyAoZWl0aGVyIHN0YXRpYyBhcnJheSBvciBkeW5hbWljIGZ1bmN0aW9uKVxuICAgICAgY29uc3QgcGVybWlzc2lvbnMgPSB0eXBlb2YgcmVxdWlyZWRQZXJtaXNzaW9ucyA9PT0gJ2Z1bmN0aW9uJyBcbiAgICAgICAgPyByZXF1aXJlZFBlcm1pc3Npb25zKHJlcSkgXG4gICAgICAgIDogcmVxdWlyZWRQZXJtaXNzaW9ucztcblxuICAgICAgLy8gQ2hlY2sgaWYgdXNlciBoYXMgcmVxdWlyZWQgcGVybWlzc2lvbnNcbiAgICAgIGNvbnN0IGhhc1Blcm1pc3Npb24gPSBhd2FpdCBjaGVja1Blcm1pc3Npb25zKHBlcm1pc3Npb25SZXEudXNlciwgcGVybWlzc2lvbnMpO1xuICAgICAgXG4gICAgICBpZiAoIWhhc1Blcm1pc3Npb24pIHtcbiAgICAgICAgbG9nZ2VyLndhcm4oJ0luc3VmZmljaWVudCBwZXJtaXNzaW9ucycsIHsgXG4gICAgICAgICAgdXNlcklkOiBwZXJtaXNzaW9uUmVxLnVzZXIuaWQsIFxuICAgICAgICAgIHVzZXJSb2xlOiBwZXJtaXNzaW9uUmVxLnVzZXIucm9sZSxcbiAgICAgICAgICByZXF1aXJlZFBlcm1pc3Npb25zOiBwZXJtaXNzaW9ucyxcbiAgICAgICAgICBwYXRoOiByZXEudXJsIFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuanNvbih7IFxuICAgICAgICAgIGVycm9yOiAnRm9yYmlkZGVuJyxcbiAgICAgICAgICBtZXNzYWdlOiAnSW5zdWZmaWNpZW50IHBlcm1pc3Npb25zIGZvciB0aGlzIG9wZXJhdGlvbicgXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBsb2dnZXIuaW5mbygnUGVybWlzc2lvbiBjaGVjayBwYXNzZWQnLCB7IFxuICAgICAgICB1c2VySWQ6IHBlcm1pc3Npb25SZXEudXNlci5pZCwgXG4gICAgICAgIHJlcXVpcmVkUGVybWlzc2lvbnM6IHBlcm1pc3Npb25zLFxuICAgICAgICBwYXRoOiByZXEudXJsIFxuICAgICAgfSk7XG5cbiAgICAgIC8vIENhbGwgdGhlIG9yaWdpbmFsIGhhbmRsZXJcbiAgICAgIGF3YWl0IGhhbmRsZXIocGVybWlzc2lvblJlcSwgcmVzKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdQZXJtaXNzaW9uIG1pZGRsZXdhcmUgZXJyb3InLCB7IGVycm9yLCBwYXRoOiByZXEudXJsIH0pO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICAgIGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyxcbiAgICAgICAgbWVzc2FnZTogJ1Blcm1pc3Npb24gY2hlY2sgZmFpbGVkJyBcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gY2hlY2tQZXJtaXNzaW9ucyh1c2VyOiBhbnksIHJlcXVpcmVkUGVybWlzc2lvbnM6IHN0cmluZ1tdKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIC8vIEZvciBub3csIGltcGxlbWVudCBhIHNpbXBsZSByb2xlLWJhc2VkIHBlcm1pc3Npb24gc3lzdGVtXG4gIC8vIFRoaXMgY2FuIGJlIGVuaGFuY2VkIGxhdGVyIHdpdGggYSBtb3JlIHNvcGhpc3RpY2F0ZWQgcGVybWlzc2lvbiBzeXN0ZW1cbiAgXG4gIGNvbnN0IHJvbGVQZXJtaXNzaW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0ge1xuICAgICdBRE1JTic6IFtcbiAgICAgICd1c2VyczpyZWFkJywgJ3VzZXJzOmNyZWF0ZScsICd1c2Vyczp1cGRhdGUnLCAndXNlcnM6ZGVsZXRlJyxcbiAgICAgICdncm91cHM6cmVhZCcsICdncm91cHM6Y3JlYXRlJywgJ2dyb3Vwczp1cGRhdGUnLCAnZ3JvdXBzOmRlbGV0ZScsXG4gICAgICAnZXZlbnRzOnJlYWQnLCAnZXZlbnRzOmNyZWF0ZScsICdldmVudHM6dXBkYXRlJywgJ2V2ZW50czpkZWxldGUnLFxuICAgICAgJ3RlYW1zOnJlYWQnLCAndGVhbXM6d3JpdGUnLCAndGVhbXM6Y3JlYXRlJywgJ3RlYW1zOnVwZGF0ZScsICd0ZWFtczpkZWxldGUnLFxuICAgICAgJ3Rhc2tzOnJlYWQnLCAndGFza3M6Y3JlYXRlJywgJ3Rhc2tzOnVwZGF0ZScsICd0YXNrczpkZWxldGUnLCAndGFza3M6ZW5xdWV1ZSdcbiAgICBdLFxuICAgICdFWEVDX0JPQVJEJzogW1xuICAgICAgJ3VzZXJzOnJlYWQnLCAndXNlcnM6Y3JlYXRlJywgJ3VzZXJzOnVwZGF0ZScsXG4gICAgICAnZ3JvdXBzOnJlYWQnLCAnZ3JvdXBzOmNyZWF0ZScsICdncm91cHM6dXBkYXRlJyxcbiAgICAgICdldmVudHM6cmVhZCcsICdldmVudHM6Y3JlYXRlJywgJ2V2ZW50czp1cGRhdGUnLFxuICAgICAgJ3RlYW1zOnJlYWQnLCAndGVhbXM6d3JpdGUnLCAndGVhbXM6Y3JlYXRlJywgJ3RlYW1zOnVwZGF0ZScsXG4gICAgICAndGFza3M6cmVhZCcsICd0YXNrczpjcmVhdGUnLCAndGFza3M6dXBkYXRlJ1xuICAgIF0sXG4gICAgJ01FTUJFUic6IFtcbiAgICAgICd1c2VyczpyZWFkJyxcbiAgICAgICdncm91cHM6cmVhZCcsXG4gICAgICAnZXZlbnRzOnJlYWQnLFxuICAgICAgJ3RlYW1zOnJlYWQnLFxuICAgICAgJ3Rhc2tzOnJlYWQnXG4gICAgXVxuICB9O1xuXG4gIC8vIENoZWNrIGlmIHVzZXIgaGFzIHRlY2gtdGVhbSBncm91cCBpbiBhdXRoZW50aWtHcm91cHMgKE9JREMgZ3JvdXBzKVxuICAvLyBJZiB0aGV5IGRvLCBnaXZlIHRoZW0gYWRtaW4gcGVybWlzc2lvbnMgcmVnYXJkbGVzcyBvZiB0aGVpciByb2xlXG4gIGxldCBlZmZlY3RpdmVSb2xlID0gdXNlci5yb2xlO1xuICBpZiAodXNlci5hdXRoZW50aWtHcm91cHMgJiYgQXJyYXkuaXNBcnJheSh1c2VyLmF1dGhlbnRpa0dyb3VwcykpIHtcbiAgICBpZiAodXNlci5hdXRoZW50aWtHcm91cHMuaW5jbHVkZXMoJ3RlY2gtdGVhbScpKSB7XG4gICAgICBlZmZlY3RpdmVSb2xlID0gJ0FETUlOJztcbiAgICAgIGxvZ2dlci5pbmZvKCdVc2VyIGhhcyB0ZWNoLXRlYW0gZ3JvdXAsIGVsZXZhdGluZyB0byBhZG1pbiBwZXJtaXNzaW9ucycsIHtcbiAgICAgICAgdXNlcklkOiB1c2VyLmlkLFxuICAgICAgICBvcmlnaW5hbFJvbGU6IHVzZXIucm9sZSxcbiAgICAgICAgYXV0aGVudGlrR3JvdXBzOiB1c2VyLmF1dGhlbnRpa0dyb3Vwc1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgdXNlclBlcm1pc3Npb25zID0gcm9sZVBlcm1pc3Npb25zW2VmZmVjdGl2ZVJvbGVdIHx8IFtdO1xuICBcbiAgLy8gQ2hlY2sgaWYgdXNlciBoYXMgYWxsIHJlcXVpcmVkIHBlcm1pc3Npb25zXG4gIHJldHVybiByZXF1aXJlZFBlcm1pc3Npb25zLmV2ZXJ5KHBlcm1pc3Npb24gPT4gdXNlclBlcm1pc3Npb25zLmluY2x1ZGVzKHBlcm1pc3Npb24pKTtcbn1cbiJdLCJuYW1lcyI6WyJsb2dnZXIiLCJ3aXRoUGVybWlzc2lvbnMiLCJoYW5kbGVyIiwicmVxdWlyZWRQZXJtaXNzaW9ucyIsInJlcSIsInJlcyIsInBlcm1pc3Npb25SZXEiLCJ1c2VyIiwid2FybiIsInBhdGgiLCJ1cmwiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJtZXNzYWdlIiwicGVybWlzc2lvbnMiLCJoYXNQZXJtaXNzaW9uIiwiY2hlY2tQZXJtaXNzaW9ucyIsInVzZXJJZCIsImlkIiwidXNlclJvbGUiLCJyb2xlIiwiaW5mbyIsInJvbGVQZXJtaXNzaW9ucyIsImVmZmVjdGl2ZVJvbGUiLCJhdXRoZW50aWtHcm91cHMiLCJBcnJheSIsImlzQXJyYXkiLCJpbmNsdWRlcyIsIm9yaWdpbmFsUm9sZSIsInVzZXJQZXJtaXNzaW9ucyIsImV2ZXJ5IiwicGVybWlzc2lvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/middleware/permissionMiddleware.ts\n");

/***/ }),

/***/ "(api)/./src/models/prismaClient.ts":
/*!************************************!*\
  !*** ./src/models/prismaClient.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst prisma = globalThis.__prisma || new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"query\",\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) {\n    globalThis.__prisma = prisma;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (prisma);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvbW9kZWxzL3ByaXNtYUNsaWVudC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQThDO0FBTXZDLE1BQU1DLFNBQVNDLFdBQVdDLFFBQVEsSUFBSSxJQUFJSCx3REFBWUEsQ0FBQztJQUM1REksS0FBS0MsS0FBeUIsR0FBZ0I7UUFBQztRQUFTO1FBQVM7S0FBTyxHQUFHLENBQVM7QUFDdEYsR0FBRztBQUVILElBQUlBLElBQXlCLEVBQWM7SUFDekNILFdBQVdDLFFBQVEsR0FBR0Y7QUFDeEI7QUFFQSxpRUFBZUEsTUFBTUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL21ybTM2MC1iYWNrZW5kLy4vc3JjL21vZGVscy9wcmlzbWFDbGllbnQudHM/N2M1MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XHJcblxyXG5kZWNsYXJlIGdsb2JhbCB7XHJcbiAgdmFyIF9fcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWQ7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBwcmlzbWEgPSBnbG9iYWxUaGlzLl9fcHJpc21hIHx8IG5ldyBQcmlzbWFDbGllbnQoe1xyXG4gIGxvZzogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBbJ3F1ZXJ5JywgJ2Vycm9yJywgJ3dhcm4nXSA6IFsnZXJyb3InXSxcclxufSk7XHJcblxyXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xyXG4gIGdsb2JhbFRoaXMuX19wcmlzbWEgPSBwcmlzbWE7XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IHByaXNtYTtcclxuIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsInByaXNtYSIsImdsb2JhbFRoaXMiLCJfX3ByaXNtYSIsImxvZyIsInByb2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/models/prismaClient.ts\n");

/***/ }),

/***/ "(api)/./src/pages/api/teams/index.ts":
/*!**************************************!*\
  !*** ./src/pages/api/teams/index.ts ***!
  \**************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"zod\");\n/* harmony import */ var _models_prismaClient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../models/prismaClient */ \"(api)/./src/models/prismaClient.ts\");\n/* harmony import */ var _managers_backgroundTaskManager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../managers/backgroundTaskManager */ \"(api)/./src/managers/backgroundTaskManager.ts\");\n/* harmony import */ var _middleware_corsMiddleware__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../middleware/corsMiddleware */ \"(api)/./src/middleware/corsMiddleware.ts\");\n/* harmony import */ var _middleware_authMiddleware__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../middleware/authMiddleware */ \"(api)/./src/middleware/authMiddleware.ts\");\n/* harmony import */ var _middleware_permissionMiddleware__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../middleware/permissionMiddleware */ \"(api)/./src/middleware/permissionMiddleware.ts\");\n/* harmony import */ var _utils_logger__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../utils/logger */ \"(api)/./src/utils/logger.ts\");\n/* harmony import */ var _tasks_queue__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../tasks/queue */ \"(api)/./src/tasks/queue.ts\");\n/* harmony import */ var _middleware_errorHandler__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../middleware/errorHandler */ \"(api)/./src/middleware/errorHandler.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([zod__WEBPACK_IMPORTED_MODULE_0__]);\nzod__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n\n\n// Validation schemas\nconst createTeamSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    name: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(1, \"Team name is required\"),\n    description: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n    type: zod__WEBPACK_IMPORTED_MODULE_0__.z.enum([\n        \"COMPETITION\",\n        \"DEVELOPMENT\"\n    ]),\n    subtype: zod__WEBPACK_IMPORTED_MODULE_0__.z.enum([\n        \"BLUE\",\n        \"RED\",\n        \"CTF\"\n    ]).optional(),\n    parentTeamId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n    groupId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n    memberIds: zod__WEBPACK_IMPORTED_MODULE_0__.z.array(zod__WEBPACK_IMPORTED_MODULE_0__.z.string()).default([]),\n    // Optional provisioning configuration\n    provisioningOptions: zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n        wikijs: zod__WEBPACK_IMPORTED_MODULE_0__.z.boolean().default(false),\n        nextcloudFolder: zod__WEBPACK_IMPORTED_MODULE_0__.z.boolean().default(false),\n        nextcloudCalendar: zod__WEBPACK_IMPORTED_MODULE_0__.z.boolean().default(false),\n        nextcloudDeck: zod__WEBPACK_IMPORTED_MODULE_0__.z.boolean().default(false),\n        github: zod__WEBPACK_IMPORTED_MODULE_0__.z.boolean().default(false),\n        discord: zod__WEBPACK_IMPORTED_MODULE_0__.z.boolean().default(false)\n    }).optional()\n});\nconst updateTeamSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    name: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(1, \"Team name is required\").optional(),\n    description: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n    type: zod__WEBPACK_IMPORTED_MODULE_0__.z.enum([\n        \"COMPETITION\",\n        \"DEVELOPMENT\"\n    ]).optional(),\n    subtype: zod__WEBPACK_IMPORTED_MODULE_0__.z.enum([\n        \"BLUE\",\n        \"RED\",\n        \"CTF\"\n    ]).optional(),\n    parentTeamId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n    groupId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n    memberIds: zod__WEBPACK_IMPORTED_MODULE_0__.z.array(zod__WEBPACK_IMPORTED_MODULE_0__.z.string()).optional()\n});\nconst listTeamsSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    page: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional().transform((val)=>parseInt(val || \"1\")),\n    limit: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional().transform((val)=>parseInt(val || \"20\")),\n    search: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n    type: zod__WEBPACK_IMPORTED_MODULE_0__.z.enum([\n        \"COMPETITION\",\n        \"DEVELOPMENT\"\n    ]).optional(),\n    groupId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional()\n});\n/**\n * @swagger\n * /api/teams:\n *   get:\n *     summary: List teams with filtering and pagination\n *     tags: [Teams]\n *     security:\n *       - sessionAuth: []\n *     parameters:\n *       - in: query\n *         name: page\n *         schema:\n *           type: integer\n *           default: 1\n *         description: Page number for pagination\n *       - in: query\n *         name: limit\n *         schema:\n *           type: integer\n *           default: 20\n *         description: Number of teams per page\n *       - in: query\n *         name: search\n *         schema:\n *           type: string\n *         description: Search term for team name\n *       - in: query\n *         name: type\n *         schema:\n *           type: string\n *           enum: [COMPETITION, DEVELOPMENT]\n *         description: Filter by team type\n *       - in: query\n *         name: groupId\n *         schema:\n *           type: string\n *         description: Filter by group ID\n *     responses:\n *       200:\n *         description: List of teams\n *         content:\n *           application/json:\n *             schema:\n *               type: object\n *               properties:\n *                 data:\n *                   type: array\n *                   items:\n *                     $ref: '#/components/schemas/Team'\n *                 pagination:\n *                   type: object\n *                   properties:\n *                     page:\n *                       type: integer\n *                     limit:\n *                       type: integer\n *                     total:\n *                       type: integer\n *                     totalPages:\n *                       type: integer\n *       401:\n *         description: Unauthorized\n *       403:\n *         description: Forbidden - insufficient permissions\n *       500:\n *         description: Internal server error\n *   post:\n *     summary: Create a new team\n *     tags: [Teams]\n *     security:\n *       - sessionAuth: []\n *     requestBody:\n *       required: true\n *       content:\n *         application/json:\n *           schema:\n *             type: object\n *             required:\n *               - name\n *               - type\n *             properties:\n *               name:\n *                 type: string\n *                 description: Team name\n *               description:\n *                 type: string\n *                 description: Team description\n *               type:\n *                 type: string\n *                 enum: [COMPETITION, DEVELOPMENT]\n *                 description: Team type\n *               subtype:\n *                 type: string\n *                 enum: [BLUE, RED, CTF]\n *                 description: Team subtype\n *               parentTeamId:\n *                 type: string\n *                 description: Parent team ID for subteams\n *               groupId:\n *                 type: string\n *                 description: Associated group ID\n *               memberIds:\n *                 type: array\n *                 items:\n *                   type: string\n *                 description: Array of user IDs to add as team members\n *     responses:\n *       201:\n *         description: Team created successfully\n *         content:\n *           application/json:\n *             schema:\n *               $ref: '#/components/schemas/Team'\n *       400:\n *         description: Bad request - validation error\n *       401:\n *         description: Unauthorized\n *       403:\n *         description: Forbidden - insufficient permissions\n *       409:\n *         description: Conflict - team name already exists\n *       500:\n *         description: Internal server error\n */ async function handler(req, res) {\n    try {\n        if (req.method === \"GET\") {\n            // List teams\n            const queryParams = listTeamsSchema.parse(req.query);\n            const { page = 1, limit = 20, search, type, groupId } = queryParams;\n            const skip = (page - 1) * limit;\n            // Build where clause\n            const where = {};\n            if (search) {\n                where.name = {\n                    contains: search,\n                    mode: \"insensitive\"\n                };\n            }\n            if (type) {\n                where.type = type;\n            }\n            if (groupId) {\n                where.groupId = groupId;\n            }\n            // Get total count\n            const total = await _models_prismaClient__WEBPACK_IMPORTED_MODULE_1__.prisma.team.count({\n                where\n            });\n            // Get teams with pagination\n            const teams = await _models_prismaClient__WEBPACK_IMPORTED_MODULE_1__.prisma.team.findMany({\n                where,\n                skip,\n                take: limit,\n                orderBy: {\n                    name: \"asc\"\n                },\n                include: {\n                    group: true,\n                    parentTeam: true,\n                    subteams: true,\n                    userTeams: {\n                        include: {\n                            user: {\n                                select: {\n                                    id: true,\n                                    email: true,\n                                    firstName: true,\n                                    lastName: true,\n                                    displayName: true,\n                                    role: true\n                                }\n                            }\n                        }\n                    }\n                }\n            });\n            const totalPages = Math.ceil(total / limit);\n            res.status(200).json({\n                data: teams,\n                pagination: {\n                    page,\n                    limit,\n                    total,\n                    totalPages\n                }\n            });\n        } else if (req.method === \"POST\") {\n            // Create team\n            const data = createTeamSchema.parse(req.body);\n            // Check if team name already exists\n            const existingTeam = await _models_prismaClient__WEBPACK_IMPORTED_MODULE_1__.prisma.team.findFirst({\n                where: {\n                    name: data.name\n                }\n            });\n            if (existingTeam) {\n                return res.status(409).json({\n                    error: \"Team with this name already exists\"\n                });\n            }\n            // Create team in database\n            const team = await _models_prismaClient__WEBPACK_IMPORTED_MODULE_1__.prisma.team.create({\n                data: {\n                    name: data.name,\n                    description: data.description,\n                    type: data.type,\n                    subtype: data.subtype,\n                    parentTeamId: data.parentTeamId,\n                    groupId: data.groupId\n                },\n                include: {\n                    group: true,\n                    parentTeam: true,\n                    subteams: true\n                }\n            });\n            // Add team members if specified\n            if (data.memberIds && data.memberIds.length > 0) {\n                const userTeams = data.memberIds.map((userId)=>({\n                        userId,\n                        teamId: team.id,\n                        role: \"MEMBER\"\n                    }));\n                await _models_prismaClient__WEBPACK_IMPORTED_MODULE_1__.prisma.userTeam.createMany({\n                    data: userTeams\n                });\n            }\n            // Prepare task data\n            const taskData = {\n                teamId: team.id,\n                action: \"create\",\n                data: {\n                    name: data.name,\n                    description: data.description,\n                    type: data.type,\n                    subtype: data.subtype,\n                    parentTeamId: data.parentTeamId,\n                    groupId: data.groupId,\n                    memberIds: data.memberIds,\n                    provisioningOptions: data.provisioningOptions\n                },\n                userId: req.user?.id || \"system\",\n                options: {\n                    authentik: true,\n                    nextcloudGroup: true,\n                    wikijs: data.provisioningOptions?.wikijs || false,\n                    nextcloudFolder: data.provisioningOptions?.nextcloudFolder || false,\n                    nextcloudCalendar: data.provisioningOptions?.nextcloudCalendar || false,\n                    nextcloudDeck: data.provisioningOptions?.nextcloudDeck || false,\n                    github: data.provisioningOptions?.github || false,\n                    discord: data.provisioningOptions?.discord || false\n                }\n            };\n            try {\n                // Create background task now so it appears immediately in UI\n                const backgroundTaskManager = new _managers_backgroundTaskManager__WEBPACK_IMPORTED_MODULE_2__.BackgroundTaskManager(_models_prismaClient__WEBPACK_IMPORTED_MODULE_1__.prisma);\n                const backgroundTask = await backgroundTaskManager.createTask({\n                    name: `Team create`,\n                    description: `Provisioning for team ${team.id}`,\n                    entityType: \"TEAM\",\n                    entityId: team.id,\n                    subtaskNames: [\n                        \"Authentik\",\n                        \"Wiki.js\",\n                        \"Nextcloud\",\n                        \"GitHub\",\n                        \"Discord\"\n                    ]\n                });\n                await (0,_tasks_queue__WEBPACK_IMPORTED_MODULE_7__.addJobToQueue)(\"TEAM_PROVISIONING\", {\n                    ...taskData,\n                    backgroundTaskId: backgroundTask.id\n                });\n                _utils_logger__WEBPACK_IMPORTED_MODULE_6__.logger.info(`Queued team provisioning task for team: ${team.id}`);\n            } catch (error) {\n                _utils_logger__WEBPACK_IMPORTED_MODULE_6__.logger.error(\"Failed to queue team provisioning task:\", error);\n            // Don't fail the request if provisioning fails\n            }\n            res.status(201).json(team);\n        } else {\n            res.status(405).json({\n                error: \"Method not allowed\"\n            });\n        }\n    } catch (error) {\n        if (error instanceof zod__WEBPACK_IMPORTED_MODULE_0__.z.ZodError) {\n            _utils_logger__WEBPACK_IMPORTED_MODULE_6__.logger.warn(\"Validation error in teams API\", {\n                errors: error.errors\n            });\n            return res.status(400).json({\n                error: \"Validation error\",\n                details: error.errors\n            });\n        }\n        // Handle custom API errors (like CONFLICT, NOT_FOUND, etc.)\n        if (error instanceof Error && error.statusCode) {\n            return (0,_middleware_errorHandler__WEBPACK_IMPORTED_MODULE_8__.handleApiError)(error, req, res);\n        }\n        _utils_logger__WEBPACK_IMPORTED_MODULE_6__.logger.error(\"Error in teams API\", {\n            error,\n            method: req.method\n        });\n        res.status(500).json({\n            error: \"Internal server error\"\n        });\n    }\n}\n// Apply middleware: CORS, authentication then permissions\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_middleware_corsMiddleware__WEBPACK_IMPORTED_MODULE_3__.withCORS)((0,_middleware_authMiddleware__WEBPACK_IMPORTED_MODULE_4__.withAuth)((0,_middleware_permissionMiddleware__WEBPACK_IMPORTED_MODULE_5__.withPermissions)(handler, [\n    \"teams:read\",\n    \"teams:write\"\n]))));\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL3RlYW1zL2luZGV4LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDd0I7QUFDOEI7QUFFMEI7QUFDbEI7QUFDQTtBQUNhO0FBQzVCO0FBQ007QUFDdUI7QUFFNUUscUJBQXFCO0FBQ3JCLE1BQU1TLG1CQUFtQlQsa0NBQUNBLENBQUNVLE1BQU0sQ0FBQztJQUNoQ0MsTUFBTVgsa0NBQUNBLENBQUNZLE1BQU0sR0FBR0MsR0FBRyxDQUFDLEdBQUc7SUFDeEJDLGFBQWFkLGtDQUFDQSxDQUFDWSxNQUFNLEdBQUdHLFFBQVE7SUFDaENDLE1BQU1oQixrQ0FBQ0EsQ0FBQ2lCLElBQUksQ0FBQztRQUFDO1FBQWU7S0FBYztJQUMzQ0MsU0FBU2xCLGtDQUFDQSxDQUFDaUIsSUFBSSxDQUFDO1FBQUM7UUFBUTtRQUFPO0tBQU0sRUFBRUYsUUFBUTtJQUNoREksY0FBY25CLGtDQUFDQSxDQUFDWSxNQUFNLEdBQUdHLFFBQVE7SUFDakNLLFNBQVNwQixrQ0FBQ0EsQ0FBQ1ksTUFBTSxHQUFHRyxRQUFRO0lBQzVCTSxXQUFXckIsa0NBQUNBLENBQUNzQixLQUFLLENBQUN0QixrQ0FBQ0EsQ0FBQ1ksTUFBTSxJQUFJVyxPQUFPLENBQUMsRUFBRTtJQUN6QyxzQ0FBc0M7SUFDdENDLHFCQUFxQnhCLGtDQUFDQSxDQUFDVSxNQUFNLENBQUM7UUFDNUJlLFFBQVF6QixrQ0FBQ0EsQ0FBQzBCLE9BQU8sR0FBR0gsT0FBTyxDQUFDO1FBQzVCSSxpQkFBaUIzQixrQ0FBQ0EsQ0FBQzBCLE9BQU8sR0FBR0gsT0FBTyxDQUFDO1FBQ3JDSyxtQkFBbUI1QixrQ0FBQ0EsQ0FBQzBCLE9BQU8sR0FBR0gsT0FBTyxDQUFDO1FBQ3ZDTSxlQUFlN0Isa0NBQUNBLENBQUMwQixPQUFPLEdBQUdILE9BQU8sQ0FBQztRQUNuQ08sUUFBUTlCLGtDQUFDQSxDQUFDMEIsT0FBTyxHQUFHSCxPQUFPLENBQUM7UUFDNUJRLFNBQVMvQixrQ0FBQ0EsQ0FBQzBCLE9BQU8sR0FBR0gsT0FBTyxDQUFDO0lBQy9CLEdBQUdSLFFBQVE7QUFDYjtBQUVBLE1BQU1pQixtQkFBbUJoQyxrQ0FBQ0EsQ0FBQ1UsTUFBTSxDQUFDO0lBQ2hDQyxNQUFNWCxrQ0FBQ0EsQ0FBQ1ksTUFBTSxHQUFHQyxHQUFHLENBQUMsR0FBRyx5QkFBeUJFLFFBQVE7SUFDekRELGFBQWFkLGtDQUFDQSxDQUFDWSxNQUFNLEdBQUdHLFFBQVE7SUFDaENDLE1BQU1oQixrQ0FBQ0EsQ0FBQ2lCLElBQUksQ0FBQztRQUFDO1FBQWU7S0FBYyxFQUFFRixRQUFRO0lBQ3JERyxTQUFTbEIsa0NBQUNBLENBQUNpQixJQUFJLENBQUM7UUFBQztRQUFRO1FBQU87S0FBTSxFQUFFRixRQUFRO0lBQ2hESSxjQUFjbkIsa0NBQUNBLENBQUNZLE1BQU0sR0FBR0csUUFBUTtJQUNqQ0ssU0FBU3BCLGtDQUFDQSxDQUFDWSxNQUFNLEdBQUdHLFFBQVE7SUFDNUJNLFdBQVdyQixrQ0FBQ0EsQ0FBQ3NCLEtBQUssQ0FBQ3RCLGtDQUFDQSxDQUFDWSxNQUFNLElBQUlHLFFBQVE7QUFDekM7QUFFQSxNQUFNa0Isa0JBQWtCakMsa0NBQUNBLENBQUNVLE1BQU0sQ0FBQztJQUMvQndCLE1BQU1sQyxrQ0FBQ0EsQ0FBQ1ksTUFBTSxHQUFHRyxRQUFRLEdBQUdvQixTQUFTLENBQUNDLENBQUFBLE1BQU9DLFNBQVNELE9BQU87SUFDN0RFLE9BQU90QyxrQ0FBQ0EsQ0FBQ1ksTUFBTSxHQUFHRyxRQUFRLEdBQUdvQixTQUFTLENBQUNDLENBQUFBLE1BQU9DLFNBQVNELE9BQU87SUFDOURHLFFBQVF2QyxrQ0FBQ0EsQ0FBQ1ksTUFBTSxHQUFHRyxRQUFRO0lBQzNCQyxNQUFNaEIsa0NBQUNBLENBQUNpQixJQUFJLENBQUM7UUFBQztRQUFlO0tBQWMsRUFBRUYsUUFBUTtJQUNyREssU0FBU3BCLGtDQUFDQSxDQUFDWSxNQUFNLEdBQUdHLFFBQVE7QUFDOUI7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0NBMkhDLEdBQ0QsZUFBZXlCLFFBQVFDLEdBQW1CLEVBQUVDLEdBQW9CO0lBQzlELElBQUk7UUFDRixJQUFJRCxJQUFJRSxNQUFNLEtBQUssT0FBTztZQUN4QixhQUFhO1lBQ2IsTUFBTUMsY0FBY1gsZ0JBQWdCWSxLQUFLLENBQUNKLElBQUlLLEtBQUs7WUFFbkQsTUFBTSxFQUFFWixPQUFPLENBQUMsRUFBRUksUUFBUSxFQUFFLEVBQUVDLE1BQU0sRUFBRXZCLElBQUksRUFBRUksT0FBTyxFQUFFLEdBQUd3QjtZQUN4RCxNQUFNRyxPQUFPLENBQUNiLE9BQU8sS0FBS0k7WUFFMUIscUJBQXFCO1lBQ3JCLE1BQU1VLFFBQWEsQ0FBQztZQUNwQixJQUFJVCxRQUFRO2dCQUNWUyxNQUFNckMsSUFBSSxHQUFHO29CQUFFc0MsVUFBVVY7b0JBQVFXLE1BQU07Z0JBQWM7WUFDdkQ7WUFDQSxJQUFJbEMsTUFBTTtnQkFDUmdDLE1BQU1oQyxJQUFJLEdBQUdBO1lBQ2Y7WUFDQSxJQUFJSSxTQUFTO2dCQUNYNEIsTUFBTTVCLE9BQU8sR0FBR0E7WUFDbEI7WUFFQSxrQkFBa0I7WUFDbEIsTUFBTStCLFFBQVEsTUFBTWxELHdEQUFNQSxDQUFDbUQsSUFBSSxDQUFDQyxLQUFLLENBQUM7Z0JBQUVMO1lBQU07WUFFOUMsNEJBQTRCO1lBQzVCLE1BQU1NLFFBQVEsTUFBTXJELHdEQUFNQSxDQUFDbUQsSUFBSSxDQUFDRyxRQUFRLENBQUM7Z0JBQ3ZDUDtnQkFDQUQ7Z0JBQ0FTLE1BQU1sQjtnQkFDTm1CLFNBQVM7b0JBQUU5QyxNQUFNO2dCQUFNO2dCQUN2QitDLFNBQVM7b0JBQ1BDLE9BQU87b0JBQ1BDLFlBQVk7b0JBQ1pDLFVBQVU7b0JBQ1ZDLFdBQVc7d0JBQ1RKLFNBQVM7NEJBQ1BLLE1BQU07Z0NBQ0pDLFFBQVE7b0NBQ05DLElBQUk7b0NBQ0pDLE9BQU87b0NBQ1BDLFdBQVc7b0NBQ1hDLFVBQVU7b0NBQ1ZDLGFBQWE7b0NBQ2JDLE1BQU07Z0NBQ1I7NEJBQ0Y7d0JBQ0Y7b0JBQ0Y7Z0JBQ0Y7WUFDRjtZQUVBLE1BQU1DLGFBQWFDLEtBQUtDLElBQUksQ0FBQ3RCLFFBQVFiO1lBRXJDSSxJQUFJZ0MsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFDbkJDLE1BQU10QjtnQkFDTnVCLFlBQVk7b0JBQ1YzQztvQkFDQUk7b0JBQ0FhO29CQUNBb0I7Z0JBQ0Y7WUFDRjtRQUVGLE9BQU8sSUFBSTlCLElBQUlFLE1BQU0sS0FBSyxRQUFRO1lBQ2hDLGNBQWM7WUFDZCxNQUFNaUMsT0FBT25FLGlCQUFpQm9DLEtBQUssQ0FBQ0osSUFBSXFDLElBQUk7WUFFNUMsb0NBQW9DO1lBQ3BDLE1BQU1DLGVBQWUsTUFBTTlFLHdEQUFNQSxDQUFDbUQsSUFBSSxDQUFDNEIsU0FBUyxDQUFDO2dCQUMvQ2hDLE9BQU87b0JBQUVyQyxNQUFNaUUsS0FBS2pFLElBQUk7Z0JBQUM7WUFDM0I7WUFFQSxJQUFJb0UsY0FBYztnQkFDaEIsT0FBT3JDLElBQUlnQyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO29CQUMxQk0sT0FBTztnQkFDVDtZQUNGO1lBRUEsMEJBQTBCO1lBQzFCLE1BQU03QixPQUFPLE1BQU1uRCx3REFBTUEsQ0FBQ21ELElBQUksQ0FBQzhCLE1BQU0sQ0FBQztnQkFDcENOLE1BQU07b0JBQ0pqRSxNQUFNaUUsS0FBS2pFLElBQUk7b0JBQ2ZHLGFBQWE4RCxLQUFLOUQsV0FBVztvQkFDN0JFLE1BQU00RCxLQUFLNUQsSUFBSTtvQkFDZkUsU0FBUzBELEtBQUsxRCxPQUFPO29CQUNyQkMsY0FBY3lELEtBQUt6RCxZQUFZO29CQUMvQkMsU0FBU3dELEtBQUt4RCxPQUFPO2dCQUN2QjtnQkFDQXNDLFNBQVM7b0JBQ1BDLE9BQU87b0JBQ1BDLFlBQVk7b0JBQ1pDLFVBQVU7Z0JBQ1o7WUFDRjtZQUVBLGdDQUFnQztZQUNoQyxJQUFJZSxLQUFLdkQsU0FBUyxJQUFJdUQsS0FBS3ZELFNBQVMsQ0FBQzhELE1BQU0sR0FBRyxHQUFHO2dCQUMvQyxNQUFNckIsWUFBWWMsS0FBS3ZELFNBQVMsQ0FBQytELEdBQUcsQ0FBQ0MsQ0FBQUEsU0FBVzt3QkFDOUNBO3dCQUNBQyxRQUFRbEMsS0FBS2EsRUFBRTt3QkFDZkssTUFBTTtvQkFDUjtnQkFFQSxNQUFNckUsd0RBQU1BLENBQUNzRixRQUFRLENBQUNDLFVBQVUsQ0FBQztvQkFDL0JaLE1BQU1kO2dCQUNSO1lBQ0Y7WUFFQSxvQkFBb0I7WUFDcEIsTUFBTTJCLFdBQVc7Z0JBQ2ZILFFBQVFsQyxLQUFLYSxFQUFFO2dCQUNmeUIsUUFBUTtnQkFDUmQsTUFBTTtvQkFDSmpFLE1BQU1pRSxLQUFLakUsSUFBSTtvQkFDZkcsYUFBYThELEtBQUs5RCxXQUFXO29CQUM3QkUsTUFBTTRELEtBQUs1RCxJQUFJO29CQUNmRSxTQUFTMEQsS0FBSzFELE9BQU87b0JBQ3JCQyxjQUFjeUQsS0FBS3pELFlBQVk7b0JBQy9CQyxTQUFTd0QsS0FBS3hELE9BQU87b0JBQ3JCQyxXQUFXdUQsS0FBS3ZELFNBQVM7b0JBQ3pCRyxxQkFBcUJvRCxLQUFLcEQsbUJBQW1CO2dCQUMvQztnQkFDQTZELFFBQVEsSUFBYXRCLElBQUksRUFBRUUsTUFBTTtnQkFDakMwQixTQUFTO29CQUNQQyxXQUFXO29CQUNYQyxnQkFBZ0I7b0JBQ2hCcEUsUUFBUW1ELEtBQUtwRCxtQkFBbUIsRUFBRUMsVUFBVTtvQkFDNUNFLGlCQUFpQmlELEtBQUtwRCxtQkFBbUIsRUFBRUcsbUJBQW1CO29CQUM5REMsbUJBQW1CZ0QsS0FBS3BELG1CQUFtQixFQUFFSSxxQkFBcUI7b0JBQ2xFQyxlQUFlK0MsS0FBS3BELG1CQUFtQixFQUFFSyxpQkFBaUI7b0JBQzFEQyxRQUFROEMsS0FBS3BELG1CQUFtQixFQUFFTSxVQUFVO29CQUM1Q0MsU0FBUzZDLEtBQUtwRCxtQkFBbUIsRUFBRU8sV0FBVztnQkFDaEQ7WUFDRjtZQUVBLElBQUk7Z0JBQ0YsNkRBQTZEO2dCQUM3RCxNQUFNK0Qsd0JBQXdCLElBQUk1RixrRkFBcUJBLENBQUNELHdEQUFNQTtnQkFDOUQsTUFBTThGLGlCQUFpQixNQUFNRCxzQkFBc0JFLFVBQVUsQ0FBQztvQkFDNURyRixNQUFNLENBQUMsV0FBVyxDQUFDO29CQUNuQkcsYUFBYSxDQUFDLHNCQUFzQixFQUFFc0MsS0FBS2EsRUFBRSxDQUFDLENBQUM7b0JBQy9DZ0MsWUFBWTtvQkFDWkMsVUFBVTlDLEtBQUthLEVBQUU7b0JBQ2pCa0MsY0FBYzt3QkFBQzt3QkFBYTt3QkFBVzt3QkFBYTt3QkFBVTtxQkFBVTtnQkFDMUU7Z0JBRUEsTUFBTTVGLDJEQUFhQSxDQUFDLHFCQUFxQjtvQkFBRSxHQUFHa0YsUUFBUTtvQkFBRVcsa0JBQWtCTCxlQUFlOUIsRUFBRTtnQkFBQztnQkFDNUYzRCxpREFBTUEsQ0FBQytGLElBQUksQ0FBQyxDQUFDLHdDQUF3QyxFQUFFakQsS0FBS2EsRUFBRSxDQUFDLENBQUM7WUFDbEUsRUFBRSxPQUFPZ0IsT0FBTztnQkFDZDNFLGlEQUFNQSxDQUFDMkUsS0FBSyxDQUFDLDJDQUEyQ0E7WUFDeEQsK0NBQStDO1lBQ2pEO1lBRUF2QyxJQUFJZ0MsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQ3ZCO1FBRXZCLE9BQU87WUFDTFYsSUFBSWdDLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVNLE9BQU87WUFBcUI7UUFDckQ7SUFDRixFQUFFLE9BQU9BLE9BQU87UUFDZCxJQUFJQSxpQkFBaUJqRixrQ0FBQ0EsQ0FBQ3NHLFFBQVEsRUFBRTtZQUMvQmhHLGlEQUFNQSxDQUFDaUcsSUFBSSxDQUFDLGlDQUFpQztnQkFBRUMsUUFBUXZCLE1BQU11QixNQUFNO1lBQUM7WUFDcEUsT0FBTzlELElBQUlnQyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFTSxPQUFPO2dCQUFvQndCLFNBQVN4QixNQUFNdUIsTUFBTTtZQUFDO1FBQ2pGO1FBRUEsNERBQTREO1FBQzVELElBQUl2QixpQkFBaUJ5QixTQUFTLE1BQW9CQyxVQUFVLEVBQUU7WUFDNUQsT0FBT25HLHdFQUFjQSxDQUFDeUUsT0FBT3hDLEtBQUtDO1FBQ3BDO1FBRUFwQyxpREFBTUEsQ0FBQzJFLEtBQUssQ0FBQyxzQkFBc0I7WUFBRUE7WUFBT3RDLFFBQVFGLElBQUlFLE1BQU07UUFBQztRQUMvREQsSUFBSWdDLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRU0sT0FBTztRQUF3QjtJQUN4RDtBQUNGO0FBRUEsMERBQTBEO0FBQzFELGlFQUFlOUUsb0VBQVFBLENBQ3JCQyxvRUFBUUEsQ0FDTkMsaUZBQWVBLENBQ2JtQyxTQUNBO0lBQUM7SUFBYztDQUFjLEtBR2pDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXJtMzYwLWJhY2tlbmQvLi9zcmMvcGFnZXMvYXBpL3RlYW1zL2luZGV4LnRzP2M1NmIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuLi8uLi8uLi9tb2RlbHMvcHJpc21hQ2xpZW50JztcbmltcG9ydCB7IFRlYW1NYW5hZ2VyIH0gZnJvbSAnLi4vLi4vLi4vbWFuYWdlcnMvdGVhbU1hbmFnZXInO1xuaW1wb3J0IHsgQmFja2dyb3VuZFRhc2tNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vLi4vbWFuYWdlcnMvYmFja2dyb3VuZFRhc2tNYW5hZ2VyJztcbmltcG9ydCB7IHdpdGhDT1JTIH0gZnJvbSAnLi4vLi4vLi4vbWlkZGxld2FyZS9jb3JzTWlkZGxld2FyZSc7XG5pbXBvcnQgeyB3aXRoQXV0aCB9IGZyb20gJy4uLy4uLy4uL21pZGRsZXdhcmUvYXV0aE1pZGRsZXdhcmUnO1xuaW1wb3J0IHsgd2l0aFBlcm1pc3Npb25zIH0gZnJvbSAnLi4vLi4vLi4vbWlkZGxld2FyZS9wZXJtaXNzaW9uTWlkZGxld2FyZSc7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICcuLi8uLi8uLi91dGlscy9sb2dnZXInO1xuaW1wb3J0IHsgYWRkSm9iVG9RdWV1ZSB9IGZyb20gJy4uLy4uLy4uL3Rhc2tzL3F1ZXVlJztcbmltcG9ydCB7IGhhbmRsZUFwaUVycm9yLCBBcGlFcnJvciB9IGZyb20gJy4uLy4uLy4uL21pZGRsZXdhcmUvZXJyb3JIYW5kbGVyJztcblxuLy8gVmFsaWRhdGlvbiBzY2hlbWFzXG5jb25zdCBjcmVhdGVUZWFtU2NoZW1hID0gei5vYmplY3Qoe1xuICBuYW1lOiB6LnN0cmluZygpLm1pbigxLCAnVGVhbSBuYW1lIGlzIHJlcXVpcmVkJyksXG4gIGRlc2NyaXB0aW9uOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIHR5cGU6IHouZW51bShbJ0NPTVBFVElUSU9OJywgJ0RFVkVMT1BNRU5UJ10pLFxuICBzdWJ0eXBlOiB6LmVudW0oWydCTFVFJywgJ1JFRCcsICdDVEYnXSkub3B0aW9uYWwoKSxcbiAgcGFyZW50VGVhbUlkOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIGdyb3VwSWQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgbWVtYmVySWRzOiB6LmFycmF5KHouc3RyaW5nKCkpLmRlZmF1bHQoW10pLFxuICAvLyBPcHRpb25hbCBwcm92aXNpb25pbmcgY29uZmlndXJhdGlvblxuICBwcm92aXNpb25pbmdPcHRpb25zOiB6Lm9iamVjdCh7XG4gICAgd2lraWpzOiB6LmJvb2xlYW4oKS5kZWZhdWx0KGZhbHNlKSxcbiAgICBuZXh0Y2xvdWRGb2xkZXI6IHouYm9vbGVhbigpLmRlZmF1bHQoZmFsc2UpLFxuICAgIG5leHRjbG91ZENhbGVuZGFyOiB6LmJvb2xlYW4oKS5kZWZhdWx0KGZhbHNlKSxcbiAgICBuZXh0Y2xvdWREZWNrOiB6LmJvb2xlYW4oKS5kZWZhdWx0KGZhbHNlKSxcbiAgICBnaXRodWI6IHouYm9vbGVhbigpLmRlZmF1bHQoZmFsc2UpLFxuICAgIGRpc2NvcmQ6IHouYm9vbGVhbigpLmRlZmF1bHQoZmFsc2UpXG4gIH0pLm9wdGlvbmFsKClcbn0pO1xuXG5jb25zdCB1cGRhdGVUZWFtU2NoZW1hID0gei5vYmplY3Qoe1xuICBuYW1lOiB6LnN0cmluZygpLm1pbigxLCAnVGVhbSBuYW1lIGlzIHJlcXVpcmVkJykub3B0aW9uYWwoKSxcbiAgZGVzY3JpcHRpb246IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgdHlwZTogei5lbnVtKFsnQ09NUEVUSVRJT04nLCAnREVWRUxPUE1FTlQnXSkub3B0aW9uYWwoKSxcbiAgc3VidHlwZTogei5lbnVtKFsnQkxVRScsICdSRUQnLCAnQ1RGJ10pLm9wdGlvbmFsKCksXG4gIHBhcmVudFRlYW1JZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBncm91cElkOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIG1lbWJlcklkczogei5hcnJheSh6LnN0cmluZygpKS5vcHRpb25hbCgpXG59KTtcblxuY29uc3QgbGlzdFRlYW1zU2NoZW1hID0gei5vYmplY3Qoe1xuICBwYWdlOiB6LnN0cmluZygpLm9wdGlvbmFsKCkudHJhbnNmb3JtKHZhbCA9PiBwYXJzZUludCh2YWwgfHwgJzEnKSksXG4gIGxpbWl0OiB6LnN0cmluZygpLm9wdGlvbmFsKCkudHJhbnNmb3JtKHZhbCA9PiBwYXJzZUludCh2YWwgfHwgJzIwJykpLFxuICBzZWFyY2g6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgdHlwZTogei5lbnVtKFsnQ09NUEVUSVRJT04nLCAnREVWRUxPUE1FTlQnXSkub3B0aW9uYWwoKSxcbiAgZ3JvdXBJZDogei5zdHJpbmcoKS5vcHRpb25hbCgpXG59KTtcblxuLyoqXG4gKiBAc3dhZ2dlclxuICogL2FwaS90ZWFtczpcbiAqICAgZ2V0OlxuICogICAgIHN1bW1hcnk6IExpc3QgdGVhbXMgd2l0aCBmaWx0ZXJpbmcgYW5kIHBhZ2luYXRpb25cbiAqICAgICB0YWdzOiBbVGVhbXNdXG4gKiAgICAgc2VjdXJpdHk6XG4gKiAgICAgICAtIHNlc3Npb25BdXRoOiBbXVxuICogICAgIHBhcmFtZXRlcnM6XG4gKiAgICAgICAtIGluOiBxdWVyeVxuICogICAgICAgICBuYW1lOiBwYWdlXG4gKiAgICAgICAgIHNjaGVtYTpcbiAqICAgICAgICAgICB0eXBlOiBpbnRlZ2VyXG4gKiAgICAgICAgICAgZGVmYXVsdDogMVxuICogICAgICAgICBkZXNjcmlwdGlvbjogUGFnZSBudW1iZXIgZm9yIHBhZ2luYXRpb25cbiAqICAgICAgIC0gaW46IHF1ZXJ5XG4gKiAgICAgICAgIG5hbWU6IGxpbWl0XG4gKiAgICAgICAgIHNjaGVtYTpcbiAqICAgICAgICAgICB0eXBlOiBpbnRlZ2VyXG4gKiAgICAgICAgICAgZGVmYXVsdDogMjBcbiAqICAgICAgICAgZGVzY3JpcHRpb246IE51bWJlciBvZiB0ZWFtcyBwZXIgcGFnZVxuICogICAgICAgLSBpbjogcXVlcnlcbiAqICAgICAgICAgbmFtZTogc2VhcmNoXG4gKiAgICAgICAgIHNjaGVtYTpcbiAqICAgICAgICAgICB0eXBlOiBzdHJpbmdcbiAqICAgICAgICAgZGVzY3JpcHRpb246IFNlYXJjaCB0ZXJtIGZvciB0ZWFtIG5hbWVcbiAqICAgICAgIC0gaW46IHF1ZXJ5XG4gKiAgICAgICAgIG5hbWU6IHR5cGVcbiAqICAgICAgICAgc2NoZW1hOlxuICogICAgICAgICAgIHR5cGU6IHN0cmluZ1xuICogICAgICAgICAgIGVudW06IFtDT01QRVRJVElPTiwgREVWRUxPUE1FTlRdXG4gKiAgICAgICAgIGRlc2NyaXB0aW9uOiBGaWx0ZXIgYnkgdGVhbSB0eXBlXG4gKiAgICAgICAtIGluOiBxdWVyeVxuICogICAgICAgICBuYW1lOiBncm91cElkXG4gKiAgICAgICAgIHNjaGVtYTpcbiAqICAgICAgICAgICB0eXBlOiBzdHJpbmdcbiAqICAgICAgICAgZGVzY3JpcHRpb246IEZpbHRlciBieSBncm91cCBJRFxuICogICAgIHJlc3BvbnNlczpcbiAqICAgICAgIDIwMDpcbiAqICAgICAgICAgZGVzY3JpcHRpb246IExpc3Qgb2YgdGVhbXNcbiAqICAgICAgICAgY29udGVudDpcbiAqICAgICAgICAgICBhcHBsaWNhdGlvbi9qc29uOlxuICogICAgICAgICAgICAgc2NoZW1hOlxuICogICAgICAgICAgICAgICB0eXBlOiBvYmplY3RcbiAqICAgICAgICAgICAgICAgcHJvcGVydGllczpcbiAqICAgICAgICAgICAgICAgICBkYXRhOlxuICogICAgICAgICAgICAgICAgICAgdHlwZTogYXJyYXlcbiAqICAgICAgICAgICAgICAgICAgIGl0ZW1zOlxuICogICAgICAgICAgICAgICAgICAgICAkcmVmOiAnIy9jb21wb25lbnRzL3NjaGVtYXMvVGVhbSdcbiAqICAgICAgICAgICAgICAgICBwYWdpbmF0aW9uOlxuICogICAgICAgICAgICAgICAgICAgdHlwZTogb2JqZWN0XG4gKiAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOlxuICogICAgICAgICAgICAgICAgICAgICBwYWdlOlxuICogICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGludGVnZXJcbiAqICAgICAgICAgICAgICAgICAgICAgbGltaXQ6XG4gKiAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogaW50ZWdlclxuICogICAgICAgICAgICAgICAgICAgICB0b3RhbDpcbiAqICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBpbnRlZ2VyXG4gKiAgICAgICAgICAgICAgICAgICAgIHRvdGFsUGFnZXM6XG4gKiAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogaW50ZWdlclxuICogICAgICAgNDAxOlxuICogICAgICAgICBkZXNjcmlwdGlvbjogVW5hdXRob3JpemVkXG4gKiAgICAgICA0MDM6XG4gKiAgICAgICAgIGRlc2NyaXB0aW9uOiBGb3JiaWRkZW4gLSBpbnN1ZmZpY2llbnQgcGVybWlzc2lvbnNcbiAqICAgICAgIDUwMDpcbiAqICAgICAgICAgZGVzY3JpcHRpb246IEludGVybmFsIHNlcnZlciBlcnJvclxuICogICBwb3N0OlxuICogICAgIHN1bW1hcnk6IENyZWF0ZSBhIG5ldyB0ZWFtXG4gKiAgICAgdGFnczogW1RlYW1zXVxuICogICAgIHNlY3VyaXR5OlxuICogICAgICAgLSBzZXNzaW9uQXV0aDogW11cbiAqICAgICByZXF1ZXN0Qm9keTpcbiAqICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gKiAgICAgICBjb250ZW50OlxuICogICAgICAgICBhcHBsaWNhdGlvbi9qc29uOlxuICogICAgICAgICAgIHNjaGVtYTpcbiAqICAgICAgICAgICAgIHR5cGU6IG9iamVjdFxuICogICAgICAgICAgICAgcmVxdWlyZWQ6XG4gKiAgICAgICAgICAgICAgIC0gbmFtZVxuICogICAgICAgICAgICAgICAtIHR5cGVcbiAqICAgICAgICAgICAgIHByb3BlcnRpZXM6XG4gKiAgICAgICAgICAgICAgIG5hbWU6XG4gKiAgICAgICAgICAgICAgICAgdHlwZTogc3RyaW5nXG4gKiAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFRlYW0gbmFtZVxuICogICAgICAgICAgICAgICBkZXNjcmlwdGlvbjpcbiAqICAgICAgICAgICAgICAgICB0eXBlOiBzdHJpbmdcbiAqICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogVGVhbSBkZXNjcmlwdGlvblxuICogICAgICAgICAgICAgICB0eXBlOlxuICogICAgICAgICAgICAgICAgIHR5cGU6IHN0cmluZ1xuICogICAgICAgICAgICAgICAgIGVudW06IFtDT01QRVRJVElPTiwgREVWRUxPUE1FTlRdXG4gKiAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFRlYW0gdHlwZVxuICogICAgICAgICAgICAgICBzdWJ0eXBlOlxuICogICAgICAgICAgICAgICAgIHR5cGU6IHN0cmluZ1xuICogICAgICAgICAgICAgICAgIGVudW06IFtCTFVFLCBSRUQsIENURl1cbiAqICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogVGVhbSBzdWJ0eXBlXG4gKiAgICAgICAgICAgICAgIHBhcmVudFRlYW1JZDpcbiAqICAgICAgICAgICAgICAgICB0eXBlOiBzdHJpbmdcbiAqICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogUGFyZW50IHRlYW0gSUQgZm9yIHN1YnRlYW1zXG4gKiAgICAgICAgICAgICAgIGdyb3VwSWQ6XG4gKiAgICAgICAgICAgICAgICAgdHlwZTogc3RyaW5nXG4gKiAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IEFzc29jaWF0ZWQgZ3JvdXAgSURcbiAqICAgICAgICAgICAgICAgbWVtYmVySWRzOlxuICogICAgICAgICAgICAgICAgIHR5cGU6IGFycmF5XG4gKiAgICAgICAgICAgICAgICAgaXRlbXM6XG4gKiAgICAgICAgICAgICAgICAgICB0eXBlOiBzdHJpbmdcbiAqICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogQXJyYXkgb2YgdXNlciBJRHMgdG8gYWRkIGFzIHRlYW0gbWVtYmVyc1xuICogICAgIHJlc3BvbnNlczpcbiAqICAgICAgIDIwMTpcbiAqICAgICAgICAgZGVzY3JpcHRpb246IFRlYW0gY3JlYXRlZCBzdWNjZXNzZnVsbHlcbiAqICAgICAgICAgY29udGVudDpcbiAqICAgICAgICAgICBhcHBsaWNhdGlvbi9qc29uOlxuICogICAgICAgICAgICAgc2NoZW1hOlxuICogICAgICAgICAgICAgICAkcmVmOiAnIy9jb21wb25lbnRzL3NjaGVtYXMvVGVhbSdcbiAqICAgICAgIDQwMDpcbiAqICAgICAgICAgZGVzY3JpcHRpb246IEJhZCByZXF1ZXN0IC0gdmFsaWRhdGlvbiBlcnJvclxuICogICAgICAgNDAxOlxuICogICAgICAgICBkZXNjcmlwdGlvbjogVW5hdXRob3JpemVkXG4gKiAgICAgICA0MDM6XG4gKiAgICAgICAgIGRlc2NyaXB0aW9uOiBGb3JiaWRkZW4gLSBpbnN1ZmZpY2llbnQgcGVybWlzc2lvbnNcbiAqICAgICAgIDQwOTpcbiAqICAgICAgICAgZGVzY3JpcHRpb246IENvbmZsaWN0IC0gdGVhbSBuYW1lIGFscmVhZHkgZXhpc3RzXG4gKiAgICAgICA1MDA6XG4gKiAgICAgICAgIGRlc2NyaXB0aW9uOiBJbnRlcm5hbCBzZXJ2ZXIgZXJyb3JcbiAqL1xuYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICB0cnkge1xuICAgIGlmIChyZXEubWV0aG9kID09PSAnR0VUJykge1xuICAgICAgLy8gTGlzdCB0ZWFtc1xuICAgICAgY29uc3QgcXVlcnlQYXJhbXMgPSBsaXN0VGVhbXNTY2hlbWEucGFyc2UocmVxLnF1ZXJ5KTtcbiAgICAgIFxuICAgICAgY29uc3QgeyBwYWdlID0gMSwgbGltaXQgPSAyMCwgc2VhcmNoLCB0eXBlLCBncm91cElkIH0gPSBxdWVyeVBhcmFtcztcbiAgICAgIGNvbnN0IHNraXAgPSAocGFnZSAtIDEpICogbGltaXQ7XG5cbiAgICAgIC8vIEJ1aWxkIHdoZXJlIGNsYXVzZVxuICAgICAgY29uc3Qgd2hlcmU6IGFueSA9IHt9O1xuICAgICAgaWYgKHNlYXJjaCkge1xuICAgICAgICB3aGVyZS5uYW1lID0geyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH07XG4gICAgICB9XG4gICAgICBpZiAodHlwZSkge1xuICAgICAgICB3aGVyZS50eXBlID0gdHlwZTtcbiAgICAgIH1cbiAgICAgIGlmIChncm91cElkKSB7XG4gICAgICAgIHdoZXJlLmdyb3VwSWQgPSBncm91cElkO1xuICAgICAgfVxuXG4gICAgICAvLyBHZXQgdG90YWwgY291bnRcbiAgICAgIGNvbnN0IHRvdGFsID0gYXdhaXQgcHJpc21hLnRlYW0uY291bnQoeyB3aGVyZSB9KTtcblxuICAgICAgLy8gR2V0IHRlYW1zIHdpdGggcGFnaW5hdGlvblxuICAgICAgY29uc3QgdGVhbXMgPSBhd2FpdCBwcmlzbWEudGVhbS5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlLFxuICAgICAgICBza2lwLFxuICAgICAgICB0YWtlOiBsaW1pdCxcbiAgICAgICAgb3JkZXJCeTogeyBuYW1lOiAnYXNjJyB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgZ3JvdXA6IHRydWUsXG4gICAgICAgICAgcGFyZW50VGVhbTogdHJ1ZSxcbiAgICAgICAgICBzdWJ0ZWFtczogdHJ1ZSxcbiAgICAgICAgICB1c2VyVGVhbXM6IHtcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICBlbWFpbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGZpcnN0TmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGxhc3ROYW1lOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IHRydWUsXG4gICAgICAgICAgICAgICAgICByb2xlOiB0cnVlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgdG90YWxQYWdlcyA9IE1hdGguY2VpbCh0b3RhbCAvIGxpbWl0KTtcblxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgICBkYXRhOiB0ZWFtcyxcbiAgICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICAgIHBhZ2UsXG4gICAgICAgICAgbGltaXQsXG4gICAgICAgICAgdG90YWwsXG4gICAgICAgICAgdG90YWxQYWdlc1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgIH0gZWxzZSBpZiAocmVxLm1ldGhvZCA9PT0gJ1BPU1QnKSB7XG4gICAgICAvLyBDcmVhdGUgdGVhbVxuICAgICAgY29uc3QgZGF0YSA9IGNyZWF0ZVRlYW1TY2hlbWEucGFyc2UocmVxLmJvZHkpO1xuICAgICAgXG4gICAgICAvLyBDaGVjayBpZiB0ZWFtIG5hbWUgYWxyZWFkeSBleGlzdHNcbiAgICAgIGNvbnN0IGV4aXN0aW5nVGVhbSA9IGF3YWl0IHByaXNtYS50ZWFtLmZpbmRGaXJzdCh7XG4gICAgICAgIHdoZXJlOiB7IG5hbWU6IGRhdGEubmFtZSB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKGV4aXN0aW5nVGVhbSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDkpLmpzb24oeyBcbiAgICAgICAgICBlcnJvcjogJ1RlYW0gd2l0aCB0aGlzIG5hbWUgYWxyZWFkeSBleGlzdHMnIFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gQ3JlYXRlIHRlYW0gaW4gZGF0YWJhc2VcbiAgICAgIGNvbnN0IHRlYW0gPSBhd2FpdCBwcmlzbWEudGVhbS5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgICAgIHR5cGU6IGRhdGEudHlwZSxcbiAgICAgICAgICBzdWJ0eXBlOiBkYXRhLnN1YnR5cGUsXG4gICAgICAgICAgcGFyZW50VGVhbUlkOiBkYXRhLnBhcmVudFRlYW1JZCxcbiAgICAgICAgICBncm91cElkOiBkYXRhLmdyb3VwSWRcbiAgICAgICAgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIGdyb3VwOiB0cnVlLFxuICAgICAgICAgIHBhcmVudFRlYW06IHRydWUsXG4gICAgICAgICAgc3VidGVhbXM6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIEFkZCB0ZWFtIG1lbWJlcnMgaWYgc3BlY2lmaWVkXG4gICAgICBpZiAoZGF0YS5tZW1iZXJJZHMgJiYgZGF0YS5tZW1iZXJJZHMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCB1c2VyVGVhbXMgPSBkYXRhLm1lbWJlcklkcy5tYXAodXNlcklkID0+ICh7XG4gICAgICAgICAgdXNlcklkLFxuICAgICAgICAgIHRlYW1JZDogdGVhbS5pZCxcbiAgICAgICAgICByb2xlOiAnTUVNQkVSJyBhcyBjb25zdFxuICAgICAgICB9KSk7XG5cbiAgICAgICAgYXdhaXQgcHJpc21hLnVzZXJUZWFtLmNyZWF0ZU1hbnkoe1xuICAgICAgICAgIGRhdGE6IHVzZXJUZWFtc1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gUHJlcGFyZSB0YXNrIGRhdGFcbiAgICAgIGNvbnN0IHRhc2tEYXRhID0ge1xuICAgICAgICB0ZWFtSWQ6IHRlYW0uaWQsXG4gICAgICAgIGFjdGlvbjogJ2NyZWF0ZScgYXMgY29uc3QsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXG4gICAgICAgICAgdHlwZTogZGF0YS50eXBlLFxuICAgICAgICAgIHN1YnR5cGU6IGRhdGEuc3VidHlwZSxcbiAgICAgICAgICBwYXJlbnRUZWFtSWQ6IGRhdGEucGFyZW50VGVhbUlkLFxuICAgICAgICAgIGdyb3VwSWQ6IGRhdGEuZ3JvdXBJZCxcbiAgICAgICAgICBtZW1iZXJJZHM6IGRhdGEubWVtYmVySWRzLFxuICAgICAgICAgIHByb3Zpc2lvbmluZ09wdGlvbnM6IGRhdGEucHJvdmlzaW9uaW5nT3B0aW9uc1xuICAgICAgICB9LFxuICAgICAgICB1c2VySWQ6IChyZXEgYXMgYW55KS51c2VyPy5pZCB8fCAnc3lzdGVtJyxcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGF1dGhlbnRpazogdHJ1ZSwgLy8gQWx3YXlzIGVuYWJsZWRcbiAgICAgICAgICBuZXh0Y2xvdWRHcm91cDogdHJ1ZSwgLy8gQWx3YXlzIGVuYWJsZWRcbiAgICAgICAgICB3aWtpanM6IGRhdGEucHJvdmlzaW9uaW5nT3B0aW9ucz8ud2lraWpzIHx8IGZhbHNlLFxuICAgICAgICAgIG5leHRjbG91ZEZvbGRlcjogZGF0YS5wcm92aXNpb25pbmdPcHRpb25zPy5uZXh0Y2xvdWRGb2xkZXIgfHwgZmFsc2UsXG4gICAgICAgICAgbmV4dGNsb3VkQ2FsZW5kYXI6IGRhdGEucHJvdmlzaW9uaW5nT3B0aW9ucz8ubmV4dGNsb3VkQ2FsZW5kYXIgfHwgZmFsc2UsXG4gICAgICAgICAgbmV4dGNsb3VkRGVjazogZGF0YS5wcm92aXNpb25pbmdPcHRpb25zPy5uZXh0Y2xvdWREZWNrIHx8IGZhbHNlLFxuICAgICAgICAgIGdpdGh1YjogZGF0YS5wcm92aXNpb25pbmdPcHRpb25zPy5naXRodWIgfHwgZmFsc2UsXG4gICAgICAgICAgZGlzY29yZDogZGF0YS5wcm92aXNpb25pbmdPcHRpb25zPy5kaXNjb3JkIHx8IGZhbHNlXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIENyZWF0ZSBiYWNrZ3JvdW5kIHRhc2sgbm93IHNvIGl0IGFwcGVhcnMgaW1tZWRpYXRlbHkgaW4gVUlcbiAgICAgICAgY29uc3QgYmFja2dyb3VuZFRhc2tNYW5hZ2VyID0gbmV3IEJhY2tncm91bmRUYXNrTWFuYWdlcihwcmlzbWEpO1xuICAgICAgICBjb25zdCBiYWNrZ3JvdW5kVGFzayA9IGF3YWl0IGJhY2tncm91bmRUYXNrTWFuYWdlci5jcmVhdGVUYXNrKHtcbiAgICAgICAgICBuYW1lOiBgVGVhbSBjcmVhdGVgLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBgUHJvdmlzaW9uaW5nIGZvciB0ZWFtICR7dGVhbS5pZH1gLFxuICAgICAgICAgIGVudGl0eVR5cGU6ICdURUFNJyxcbiAgICAgICAgICBlbnRpdHlJZDogdGVhbS5pZCxcbiAgICAgICAgICBzdWJ0YXNrTmFtZXM6IFsnQXV0aGVudGlrJywgJ1dpa2kuanMnLCAnTmV4dGNsb3VkJywgJ0dpdEh1YicsICdEaXNjb3JkJ11cbiAgICAgICAgfSk7XG5cbiAgICAgICAgYXdhaXQgYWRkSm9iVG9RdWV1ZSgnVEVBTV9QUk9WSVNJT05JTkcnLCB7IC4uLnRhc2tEYXRhLCBiYWNrZ3JvdW5kVGFza0lkOiBiYWNrZ3JvdW5kVGFzay5pZCB9KTtcbiAgICAgICAgbG9nZ2VyLmluZm8oYFF1ZXVlZCB0ZWFtIHByb3Zpc2lvbmluZyB0YXNrIGZvciB0ZWFtOiAke3RlYW0uaWR9YCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBxdWV1ZSB0ZWFtIHByb3Zpc2lvbmluZyB0YXNrOicsIGVycm9yKTtcbiAgICAgICAgLy8gRG9uJ3QgZmFpbCB0aGUgcmVxdWVzdCBpZiBwcm92aXNpb25pbmcgZmFpbHNcbiAgICAgIH1cblxuICAgICAgcmVzLnN0YXR1cygyMDEpLmpzb24odGVhbSk7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBlcnJvcjogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIHouWm9kRXJyb3IpIHtcbiAgICAgIGxvZ2dlci53YXJuKCdWYWxpZGF0aW9uIGVycm9yIGluIHRlYW1zIEFQSScsIHsgZXJyb3JzOiBlcnJvci5lcnJvcnMgfSk7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ1ZhbGlkYXRpb24gZXJyb3InLCBkZXRhaWxzOiBlcnJvci5lcnJvcnMgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIEhhbmRsZSBjdXN0b20gQVBJIGVycm9ycyAobGlrZSBDT05GTElDVCwgTk9UX0ZPVU5ELCBldGMuKVxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIChlcnJvciBhcyBBcGlFcnJvcikuc3RhdHVzQ29kZSkge1xuICAgICAgcmV0dXJuIGhhbmRsZUFwaUVycm9yKGVycm9yLCByZXEsIHJlcyk7XG4gICAgfVxuICAgIFxuICAgIGxvZ2dlci5lcnJvcignRXJyb3IgaW4gdGVhbXMgQVBJJywgeyBlcnJvciwgbWV0aG9kOiByZXEubWV0aG9kIH0pO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0pO1xuICB9XG59XG5cbi8vIEFwcGx5IG1pZGRsZXdhcmU6IENPUlMsIGF1dGhlbnRpY2F0aW9uIHRoZW4gcGVybWlzc2lvbnNcbmV4cG9ydCBkZWZhdWx0IHdpdGhDT1JTKFxuICB3aXRoQXV0aChcbiAgICB3aXRoUGVybWlzc2lvbnMoXG4gICAgICBoYW5kbGVyLFxuICAgICAgWyd0ZWFtczpyZWFkJywgJ3RlYW1zOndyaXRlJ11cbiAgICApXG4gIClcbik7XG4iXSwibmFtZXMiOlsieiIsInByaXNtYSIsIkJhY2tncm91bmRUYXNrTWFuYWdlciIsIndpdGhDT1JTIiwid2l0aEF1dGgiLCJ3aXRoUGVybWlzc2lvbnMiLCJsb2dnZXIiLCJhZGRKb2JUb1F1ZXVlIiwiaGFuZGxlQXBpRXJyb3IiLCJjcmVhdGVUZWFtU2NoZW1hIiwib2JqZWN0IiwibmFtZSIsInN0cmluZyIsIm1pbiIsImRlc2NyaXB0aW9uIiwib3B0aW9uYWwiLCJ0eXBlIiwiZW51bSIsInN1YnR5cGUiLCJwYXJlbnRUZWFtSWQiLCJncm91cElkIiwibWVtYmVySWRzIiwiYXJyYXkiLCJkZWZhdWx0IiwicHJvdmlzaW9uaW5nT3B0aW9ucyIsIndpa2lqcyIsImJvb2xlYW4iLCJuZXh0Y2xvdWRGb2xkZXIiLCJuZXh0Y2xvdWRDYWxlbmRhciIsIm5leHRjbG91ZERlY2siLCJnaXRodWIiLCJkaXNjb3JkIiwidXBkYXRlVGVhbVNjaGVtYSIsImxpc3RUZWFtc1NjaGVtYSIsInBhZ2UiLCJ0cmFuc2Zvcm0iLCJ2YWwiLCJwYXJzZUludCIsImxpbWl0Iiwic2VhcmNoIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInF1ZXJ5UGFyYW1zIiwicGFyc2UiLCJxdWVyeSIsInNraXAiLCJ3aGVyZSIsImNvbnRhaW5zIiwibW9kZSIsInRvdGFsIiwidGVhbSIsImNvdW50IiwidGVhbXMiLCJmaW5kTWFueSIsInRha2UiLCJvcmRlckJ5IiwiaW5jbHVkZSIsImdyb3VwIiwicGFyZW50VGVhbSIsInN1YnRlYW1zIiwidXNlclRlYW1zIiwidXNlciIsInNlbGVjdCIsImlkIiwiZW1haWwiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsImRpc3BsYXlOYW1lIiwicm9sZSIsInRvdGFsUGFnZXMiLCJNYXRoIiwiY2VpbCIsInN0YXR1cyIsImpzb24iLCJkYXRhIiwicGFnaW5hdGlvbiIsImJvZHkiLCJleGlzdGluZ1RlYW0iLCJmaW5kRmlyc3QiLCJlcnJvciIsImNyZWF0ZSIsImxlbmd0aCIsIm1hcCIsInVzZXJJZCIsInRlYW1JZCIsInVzZXJUZWFtIiwiY3JlYXRlTWFueSIsInRhc2tEYXRhIiwiYWN0aW9uIiwib3B0aW9ucyIsImF1dGhlbnRpayIsIm5leHRjbG91ZEdyb3VwIiwiYmFja2dyb3VuZFRhc2tNYW5hZ2VyIiwiYmFja2dyb3VuZFRhc2siLCJjcmVhdGVUYXNrIiwiZW50aXR5VHlwZSIsImVudGl0eUlkIiwic3VidGFza05hbWVzIiwiYmFja2dyb3VuZFRhc2tJZCIsImluZm8iLCJab2RFcnJvciIsIndhcm4iLCJlcnJvcnMiLCJkZXRhaWxzIiwiRXJyb3IiLCJzdGF0dXNDb2RlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/teams/index.ts\n");

/***/ }),

/***/ "(api)/./src/tasks/queue.ts":
/*!****************************!*\
  !*** ./src/tasks/queue.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   QUEUE_NAMES: () => (/* binding */ QUEUE_NAMES),\n/* harmony export */   addJobToQueue: () => (/* binding */ addJobToQueue),\n/* harmony export */   closeQueues: () => (/* binding */ closeQueues),\n/* harmony export */   emailQueue: () => (/* binding */ emailQueue),\n/* harmony export */   getQueueHealth: () => (/* binding */ getQueueHealth),\n/* harmony export */   provisionQueue: () => (/* binding */ provisionQueue),\n/* harmony export */   qrCodeQueue: () => (/* binding */ qrCodeQueue),\n/* harmony export */   syncGroupsQueue: () => (/* binding */ syncGroupsQueue),\n/* harmony export */   teamProvisioningQueue: () => (/* binding */ teamProvisioningQueue)\n/* harmony export */ });\n/* harmony import */ var bullmq__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bullmq */ \"bullmq\");\n/* harmony import */ var bullmq__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(bullmq__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ioredis */ \"ioredis\");\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(ioredis__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_logger__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/utils/logger */ \"(api)/./src/utils/logger.ts\");\n\n\n\n// Redis connection with BullMQ-compatible options\nconst redis = new (ioredis__WEBPACK_IMPORTED_MODULE_1___default())(process.env.REDIS_URL || \"redis://localhost:6379\", {\n    maxRetriesPerRequest: null\n});\n// Queue names\nconst QUEUE_NAMES = {\n    EMAIL: \"email\",\n    QR_CODE: \"qr-code\",\n    SYNC_GROUPS: \"sync-groups\",\n    PROVISION: \"provision\",\n    TEAM_PROVISIONING: \"team-provisioning\"\n};\n// Create queues\nconst emailQueue = new bullmq__WEBPACK_IMPORTED_MODULE_0__.Queue(QUEUE_NAMES.EMAIL, {\n    connection: redis,\n    defaultJobOptions: {\n        attempts: 3,\n        backoff: {\n            type: \"exponential\",\n            delay: 2000\n        }\n    }\n});\nconst qrCodeQueue = new bullmq__WEBPACK_IMPORTED_MODULE_0__.Queue(QUEUE_NAMES.QR_CODE, {\n    connection: redis,\n    defaultJobOptions: {\n        attempts: 2,\n        backoff: {\n            type: \"exponential\",\n            delay: 1000\n        }\n    }\n});\nconst syncGroupsQueue = new bullmq__WEBPACK_IMPORTED_MODULE_0__.Queue(QUEUE_NAMES.SYNC_GROUPS, {\n    connection: redis,\n    defaultJobOptions: {\n        attempts: 5,\n        backoff: {\n            type: \"exponential\",\n            delay: 5000\n        }\n    }\n});\nconst provisionQueue = new bullmq__WEBPACK_IMPORTED_MODULE_0__.Queue(QUEUE_NAMES.PROVISION, {\n    connection: redis,\n    defaultJobOptions: {\n        attempts: 1\n    }\n});\nconst teamProvisioningQueue = new bullmq__WEBPACK_IMPORTED_MODULE_0__.Queue(QUEUE_NAMES.TEAM_PROVISIONING, {\n    connection: redis,\n    defaultJobOptions: {\n        attempts: 3,\n        backoff: {\n            type: \"exponential\",\n            delay: 5000\n        }\n    }\n});\n// Note: Not using QueueScheduler due to BullMQ version constraints\n// Note: BullMQ event handlers may need to be configured differently\n// For now, we'll log queue status through other means\n_utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info(\"All queues created and configured\");\n// Helper function to add jobs to queues\nasync function addJobToQueue(queueName, data, options) {\n    const queue = getQueueByName(queueName);\n    if (!queue) {\n        throw new Error(`Unknown queue: ${queueName}`);\n    }\n    const job = await queue.add(queueName, data, {\n        delay: options?.delay,\n        priority: options?.priority,\n        attempts: options?.attempts\n    });\n    _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info(`Added job ${job.id} to ${queueName} queue`);\n    return job;\n}\nfunction getQueueByName(queueName) {\n    switch(queueName){\n        case \"EMAIL\":\n            return emailQueue;\n        case \"QR_CODE\":\n            return qrCodeQueue;\n        case \"SYNC_GROUPS\":\n            return syncGroupsQueue;\n        case \"PROVISION\":\n            return provisionQueue;\n        case \"TEAM_PROVISIONING\":\n            return teamProvisioningQueue;\n        default:\n            return null;\n    }\n}\n// Graceful shutdown\nasync function closeQueues() {\n    await emailQueue.close();\n    await qrCodeQueue.close();\n    await syncGroupsQueue.close();\n    await provisionQueue.close();\n    await teamProvisioningQueue.close();\n    await redis.quit();\n    _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info(\"All queues closed\");\n}\n// Health check\nasync function getQueueHealth() {\n    try {\n        await redis.ping();\n        return {\n            redis: \"healthy\",\n            queues: {\n                email: await emailQueue.getJobCounts(),\n                qrCode: await qrCodeQueue.getJobCounts(),\n                syncGroups: await syncGroupsQueue.getJobCounts(),\n                provision: await provisionQueue.getJobCounts(),\n                teamProvisioning: await teamProvisioningQueue.getJobCounts()\n            }\n        };\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error(\"Queue health check failed:\", error);\n        return {\n            redis: \"unhealthy\",\n            error: error instanceof Error ? error.message : \"Unknown error\"\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQztBQUNkO0FBRUEsZUFBZTtBQUNSLGVBQWVlO0lBQ3BCLElBQUk7UUFDRixNQUFNckMsTUFBTXNDLElBQUk7UUFDaEIsT0FBTztZQUNMdEMsT0FBTztZQUNQdUMsUUFBUTtnQkFDTkMsT0FBTyxNQUFNN0IsV0FBVzhCLFlBQVk7Z0JBQ3BDQyxRQUFRLE1BQU14QixZQUFZdUIsWUFBWTtnQkFDdENFLFlBQVksTUFBTXhCLGdCQUFnQnNCLFlBQVk7Z0JBQzlDRyxXQUFXLE1BQU14QixlQUFlcUIsWUFBWTtnQkFDNUNJLGtCQUFrQixNQUFNeEIsc0JBQXNCb0IsWUFBWTtZQUM1RDtRQUNGO0lBQ0YsRUFBRSxPQUFPSyxPQUFPO1FBQ2QvQyxpREFBTUEsQ0FBQytDLEtBQUssQ0FBQyw4QkFBOEJBO1FBQzNDLE9BQU87WUFDTDlDLE9BQU87WUFDUDhDLE9BQU9BLGlCQUFpQmpCLFFBQVFpQixNQUFNQyxPQUFPLEdBQUc7UUFDbEQ7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXJtMzYwLWJhY2tlbmQvLi9zcmMvdGFza3MvcXVldWUudHM/NjI5MSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBRdWV1ZSB9IGZyb20gJ2J1bGxtcSc7XG5pbXBvcnQgUmVkaXMgZnJvbSAnaW9yZWRpcyc7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAL3V0aWxzL2xvZ2dlcic7XG5cbi8vIFJlZGlzIGNvbm5lY3Rpb24gd2l0aCBCdWxsTVEtY29tcGF0aWJsZSBvcHRpb25zXG5jb25zdCByZWRpcyA9IG5ldyBSZWRpcyhwcm9jZXNzLmVudi5SRURJU19VUkwgfHwgJ3JlZGlzOi8vbG9jYWxob3N0OjYzNzknLCB7XG4gIG1heFJldHJpZXNQZXJSZXF1ZXN0OiBudWxsXG59KTtcblxuLy8gUXVldWUgbmFtZXNcbmV4cG9ydCBjb25zdCBRVUVVRV9OQU1FUyA9IHtcbiAgRU1BSUw6ICdlbWFpbCcsXG4gIFFSX0NPREU6ICdxci1jb2RlJyxcbiAgU1lOQ19HUk9VUFM6ICdzeW5jLWdyb3VwcycsXG4gIFBST1ZJU0lPTjogJ3Byb3Zpc2lvbicsXG4gIFRFQU1fUFJPVklTSU9OSU5HOiAndGVhbS1wcm92aXNpb25pbmcnXG59IGFzIGNvbnN0O1xuXG4vLyBDcmVhdGUgcXVldWVzXG5leHBvcnQgY29uc3QgZW1haWxRdWV1ZSA9IG5ldyBRdWV1ZShRVUVVRV9OQU1FUy5FTUFJTCwge1xuICBjb25uZWN0aW9uOiByZWRpcyxcbiAgZGVmYXVsdEpvYk9wdGlvbnM6IHtcbiAgICBhdHRlbXB0czogMyxcbiAgICBiYWNrb2ZmOiB7XG4gICAgICB0eXBlOiAnZXhwb25lbnRpYWwnLFxuICAgICAgZGVsYXk6IDIwMDBcbiAgICB9XG4gIH1cbn0pO1xuXG5leHBvcnQgY29uc3QgcXJDb2RlUXVldWUgPSBuZXcgUXVldWUoUVVFVUVfTkFNRVMuUVJfQ09ERSwge1xuICBjb25uZWN0aW9uOiByZWRpcyxcbiAgZGVmYXVsdEpvYk9wdGlvbnM6IHtcbiAgICBhdHRlbXB0czogMixcbiAgICBiYWNrb2ZmOiB7XG4gICAgICB0eXBlOiAnZXhwb25lbnRpYWwnLFxuICAgICAgZGVsYXk6IDEwMDBcbiAgICB9XG4gIH1cbn0pO1xuXG5leHBvcnQgY29uc3Qgc3luY0dyb3Vwc1F1ZXVlID0gbmV3IFF1ZXVlKFFVRVVFX05BTUVTLlNZTkNfR1JPVVBTLCB7XG4gIGNvbm5lY3Rpb246IHJlZGlzLFxuICBkZWZhdWx0Sm9iT3B0aW9uczoge1xuICAgIGF0dGVtcHRzOiA1LFxuICAgIGJhY2tvZmY6IHtcbiAgICAgIHR5cGU6ICdleHBvbmVudGlhbCcsXG4gICAgICBkZWxheTogNTAwMFxuICAgIH1cbiAgfVxufSk7XG5cbmV4cG9ydCBjb25zdCBwcm92aXNpb25RdWV1ZSA9IG5ldyBRdWV1ZShRVUVVRV9OQU1FUy5QUk9WSVNJT04sIHtcbiAgY29ubmVjdGlvbjogcmVkaXMsXG4gIGRlZmF1bHRKb2JPcHRpb25zOiB7XG4gICAgYXR0ZW1wdHM6IDFcbiAgfVxufSk7XG5cbmV4cG9ydCBjb25zdCB0ZWFtUHJvdmlzaW9uaW5nUXVldWUgPSBuZXcgUXVldWUoUVVFVUVfTkFNRVMuVEVBTV9QUk9WSVNJT05JTkcsIHtcbiAgY29ubmVjdGlvbjogcmVkaXMsXG4gIGRlZmF1bHRKb2JPcHRpb25zOiB7XG4gICAgYXR0ZW1wdHM6IDMsXG4gICAgYmFja29mZjoge1xuICAgICAgdHlwZTogJ2V4cG9uZW50aWFsJyxcbiAgICAgIGRlbGF5OiA1MDAwXG4gICAgfVxuICB9XG59KTtcbi8vIE5vdGU6IE5vdCB1c2luZyBRdWV1ZVNjaGVkdWxlciBkdWUgdG8gQnVsbE1RIHZlcnNpb24gY29uc3RyYWludHNcbi8vIE5vdGU6IEJ1bGxNUSBldmVudCBoYW5kbGVycyBtYXkgbmVlZCB0byBiZSBjb25maWd1cmVkIGRpZmZlcmVudGx5XG4vLyBGb3Igbm93LCB3ZSdsbCBsb2cgcXVldWUgc3RhdHVzIHRocm91Z2ggb3RoZXIgbWVhbnNcbmxvZ2dlci5pbmZvKCdBbGwgcXVldWVzIGNyZWF0ZWQgYW5kIGNvbmZpZ3VyZWQnKTtcblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGFkZCBqb2JzIHRvIHF1ZXVlc1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZEpvYlRvUXVldWUoXG4gIHF1ZXVlTmFtZToga2V5b2YgdHlwZW9mIFFVRVVFX05BTUVTLFxuICBkYXRhOiBhbnksXG4gIG9wdGlvbnM/OiB7XG4gICAgZGVsYXk/OiBudW1iZXI7XG4gICAgcHJpb3JpdHk/OiBudW1iZXI7XG4gICAgYXR0ZW1wdHM/OiBudW1iZXI7XG4gIH1cbikge1xuICBjb25zdCBxdWV1ZSA9IGdldFF1ZXVlQnlOYW1lKHF1ZXVlTmFtZSk7XG4gIGlmICghcXVldWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gcXVldWU6ICR7cXVldWVOYW1lfWApO1xuICB9XG5cbiAgY29uc3Qgam9iID0gYXdhaXQgcXVldWUuYWRkKFxuICAgIHF1ZXVlTmFtZSxcbiAgICBkYXRhLFxuICAgIHtcbiAgICAgIGRlbGF5OiBvcHRpb25zPy5kZWxheSxcbiAgICAgIHByaW9yaXR5OiBvcHRpb25zPy5wcmlvcml0eSxcbiAgICAgIGF0dGVtcHRzOiBvcHRpb25zPy5hdHRlbXB0c1xuICAgIH1cbiAgKTtcblxuICBsb2dnZXIuaW5mbyhgQWRkZWQgam9iICR7am9iLmlkfSB0byAke3F1ZXVlTmFtZX0gcXVldWVgKTtcbiAgcmV0dXJuIGpvYjtcbn1cblxuZnVuY3Rpb24gZ2V0UXVldWVCeU5hbWUocXVldWVOYW1lOiBrZXlvZiB0eXBlb2YgUVVFVUVfTkFNRVMpIHtcbiAgc3dpdGNoIChxdWV1ZU5hbWUpIHtcbiAgICBjYXNlICdFTUFJTCc6XG4gICAgICByZXR1cm4gZW1haWxRdWV1ZTtcbiAgICBjYXNlICdRUl9DT0RFJzpcbiAgICAgIHJldHVybiBxckNvZGVRdWV1ZTtcbiAgICBjYXNlICdTWU5DX0dST1VQUyc6XG4gICAgICByZXR1cm4gc3luY0dyb3Vwc1F1ZXVlO1xuICAgIGNhc2UgJ1BST1ZJU0lPTic6XG4gICAgICByZXR1cm4gcHJvdmlzaW9uUXVldWU7XG4gICAgY2FzZSAnVEVBTV9QUk9WSVNJT05JTkcnOlxuICAgICAgcmV0dXJuIHRlYW1Qcm92aXNpb25pbmdRdWV1ZTtcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLy8gR3JhY2VmdWwgc2h1dGRvd25cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjbG9zZVF1ZXVlcygpIHtcbiAgYXdhaXQgZW1haWxRdWV1ZS5jbG9zZSgpO1xuICBhd2FpdCBxckNvZGVRdWV1ZS5jbG9zZSgpO1xuICBhd2FpdCBzeW5jR3JvdXBzUXVldWUuY2xvc2UoKTtcbiAgYXdhaXQgcHJvdmlzaW9uUXVldWUuY2xvc2UoKTtcbiAgYXdhaXQgdGVhbVByb3Zpc2lvbmluZ1F1ZXVlLmNsb3NlKCk7XG4gIGF3YWl0IHJlZGlzLnF1aXQoKTtcbiAgbG9nZ2VyLmluZm8oJ0FsbCBxdWV1ZXMgY2xvc2VkJyk7XG59XG5cbi8vIEhlYWx0aCBjaGVja1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFF1ZXVlSGVhbHRoKCkge1xuICB0cnkge1xuICAgIGF3YWl0IHJlZGlzLnBpbmcoKTtcbiAgICByZXR1cm4ge1xuICAgICAgcmVkaXM6ICdoZWFsdGh5JyxcbiAgICAgIHF1ZXVlczoge1xuICAgICAgICBlbWFpbDogYXdhaXQgZW1haWxRdWV1ZS5nZXRKb2JDb3VudHMoKSxcbiAgICAgICAgcXJDb2RlOiBhd2FpdCBxckNvZGVRdWV1ZS5nZXRKb2JDb3VudHMoKSxcbiAgICAgICAgc3luY0dyb3VwczogYXdhaXQgc3luY0dyb3Vwc1F1ZXVlLmdldEpvYkNvdW50cygpLFxuICAgICAgICBwcm92aXNpb246IGF3YWl0IHByb3Zpc2lvblF1ZXVlLmdldEpvYkNvdW50cygpLFxuICAgICAgICB0ZWFtUHJvdmlzaW9uaW5nOiBhd2FpdCB0ZWFtUHJvdmlzaW9uaW5nUXVldWUuZ2V0Sm9iQ291bnRzKClcbiAgICAgIH1cbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignUXVldWUgaGVhbHRoIGNoZWNrIGZhaWxlZDonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlZGlzOiAndW5oZWFsdGh5JyxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgIH07XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJRdWV1ZSIsIlJlZGlzIiwibG9nZ2VyIiwicmVkaXMiLCJwcm9jZXNzIiwiZW52IiwiUkVESVNfVVJMIiwibWF4UmV0cmllc1BlclJlcXVlc3QiLCJRVUVVRV9OQU1FUyIsIkVNQUlMIiwiUVJfQ09ERSIsIlNZTkNfR1JPVVBTIiwiUFJPVklTSU9OIiwiVEVBTV9QUk9WSVNJT05JTkciLCJlbWFpbFF1ZXVlIiwiY29ubmVjdGlvbiIsImRlZmF1bHRKb2JPcHRpb25zIiwiYXR0ZW1wdHMiLCJiYWNrb2ZmIiwidHlwZSIsImRlbGF5IiwicXJDb2RlUXVldWUiLCJzeW5jR3JvdXBzUXVldWUiLCJwcm92aXNpb25RdWV1ZSIsInRlYW1Qcm92aXNpb25pbmdRdWV1ZSIsImluZm8iLCJhZGRKb2JUb1F1ZXVlIiwicXVldWVOYW1lIiwiZGF0YSIsIm9wdGlvbnMiLCJxdWV1ZSIsImdldFF1ZXVlQnlOYW1lIiwiRXJyb3IiLCJqb2IiLCJhZGQiLCJwcmlvcml0eSIsImlkIiwiY2xvc2VRdWV1ZXMiLCJjbG9zZSIsInF1aXQiLCJnZXRRdWV1ZUhlYWx0aCIsInBpbmciLCJxdWV1ZXMiLCJlbWFpbCIsImdldEpvYkNvdW50cyIsInFyQ29kZSIsInN5bmNHcm91cHMiLCJwcm92aXNpb24iLCJ0ZWFtUHJvdmlzaW9uaW5nIiwiZXJyb3IiLCJtZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/tasks/queue.ts\n");

/***/ }),

/***/ "(api)/./src/utils/logger.ts":
/*!*****************************!*\
  !*** ./src/utils/logger.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LogLevel: () => (/* binding */ LogLevel),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   logger: () => (/* binding */ logger)\n/* harmony export */ });\nvar LogLevel;\n(function(LogLevel) {\n    LogLevel[LogLevel[\"DEBUG\"] = 0] = \"DEBUG\";\n    LogLevel[LogLevel[\"INFO\"] = 1] = \"INFO\";\n    LogLevel[LogLevel[\"WARN\"] = 2] = \"WARN\";\n    LogLevel[LogLevel[\"ERROR\"] = 3] = \"ERROR\";\n})(LogLevel || (LogLevel = {}));\nclass Logger {\n    constructor(level = 1){\n        this.level = level;\n    }\n    formatMessage(level, message, meta) {\n        const timestamp = new Date().toISOString();\n        const metaStr = meta ? ` ${JSON.stringify(meta)}` : \"\";\n        return `[${timestamp}] ${level}: ${message}${metaStr}`;\n    }\n    log(level, levelName, message, meta) {\n        if (level >= this.level) {\n            const formattedMessage = this.formatMessage(levelName, message, meta);\n            switch(level){\n                case 3:\n                    console.error(formattedMessage);\n                    break;\n                case 2:\n                    console.warn(formattedMessage);\n                    break;\n                case 1:\n                    console.info(formattedMessage);\n                    break;\n                case 0:\n                    console.debug(formattedMessage);\n                    break;\n            }\n        }\n    }\n    debug(message, meta) {\n        this.log(0, \"DEBUG\", message, meta);\n    }\n    info(message, meta) {\n        this.log(1, \"INFO\", message, meta);\n    }\n    warn(message, meta) {\n        this.log(2, \"WARN\", message, meta);\n    }\n    error(message, meta) {\n        this.log(3, \"ERROR\", message, meta);\n    }\n    setLevel(level) {\n        this.level = level;\n    }\n}\nconst logger = new Logger( true ? 0 : 0);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (logger);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvdXRpbHMvbG9nZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7VUFBWUE7Ozs7O0dBQUFBLGFBQUFBO0FBT1osTUFBTUM7SUFHSkMsWUFBWUMsU0FBK0IsQ0FBRTtRQUMzQyxJQUFJLENBQUNBLEtBQUssR0FBR0E7SUFDZjtJQUVRQyxjQUFjRCxLQUFhLEVBQUVFLE9BQWUsRUFBRUMsSUFBVSxFQUFVO1FBQ3hFLE1BQU1DLFlBQVksSUFBSUMsT0FBT0MsV0FBVztRQUN4QyxNQUFNQyxVQUFVSixPQUFPLENBQUMsQ0FBQyxFQUFFSyxLQUFLQyxTQUFTLENBQUNOLE1BQU0sQ0FBQyxHQUFHO1FBQ3BELE9BQU8sQ0FBQyxDQUFDLEVBQUVDLFVBQVUsRUFBRSxFQUFFSixNQUFNLEVBQUUsRUFBRUUsUUFBUSxFQUFFSyxRQUFRLENBQUM7SUFDeEQ7SUFFUUcsSUFBSVYsS0FBZSxFQUFFVyxTQUFpQixFQUFFVCxPQUFlLEVBQUVDLElBQVUsRUFBRTtRQUMzRSxJQUFJSCxTQUFTLElBQUksQ0FBQ0EsS0FBSyxFQUFFO1lBQ3ZCLE1BQU1ZLG1CQUFtQixJQUFJLENBQUNYLGFBQWEsQ0FBQ1UsV0FBV1QsU0FBU0M7WUFFaEUsT0FBUUg7Z0JBQ047b0JBQ0VhLFFBQVFDLEtBQUssQ0FBQ0Y7b0JBQ2Q7Z0JBQ0Y7b0JBQ0VDLFFBQVFFLElBQUksQ0FBQ0g7b0JBQ2I7Z0JBQ0Y7b0JBQ0VDLFFBQVFHLElBQUksQ0FBQ0o7b0JBQ2I7Z0JBQ0Y7b0JBQ0VDLFFBQVFJLEtBQUssQ0FBQ0w7b0JBQ2Q7WUFDSjtRQUNGO0lBQ0Y7SUFFQUssTUFBTWYsT0FBZSxFQUFFQyxJQUFVLEVBQUU7UUFDakMsSUFBSSxDQUFDTyxHQUFHLElBQWlCLFNBQVNSLFNBQVNDO0lBQzdDO0lBRUFhLEtBQUtkLE9BQWUsRUFBRUMsSUFBVSxFQUFFO1FBQ2hDLElBQUksQ0FBQ08sR0FBRyxJQUFnQixRQUFRUixTQUFTQztJQUMzQztJQUVBWSxLQUFLYixPQUFlLEVBQUVDLElBQVUsRUFBRTtRQUNoQyxJQUFJLENBQUNPLEdBQUcsSUFBZ0IsUUFBUVIsU0FBU0M7SUFDM0M7SUFFQVcsTUFBTVosT0FBZSxFQUFFQyxJQUFVLEVBQUU7UUFDakMsSUFBSSxDQUFDTyxHQUFHLElBQWlCLFNBQVNSLFNBQVNDO0lBQzdDO0lBRUFlLFNBQVNsQixLQUFlLEVBQUU7UUFDeEIsSUFBSSxDQUFDQSxLQUFLLEdBQUdBO0lBQ2Y7QUFDRjtBQUVPLE1BQU1tQixTQUFTLElBQUlyQixPQUN4QnNCLEtBQXlCLFVBQ3pCO0FBRUYsaUVBQWVELE1BQU1BLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tcm0zNjAtYmFja2VuZC8uL3NyYy91dGlscy9sb2dnZXIudHM/N2NmZiJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZW51bSBMb2dMZXZlbCB7XHJcbiAgREVCVUcgPSAwLFxyXG4gIElORk8gPSAxLFxyXG4gIFdBUk4gPSAyLFxyXG4gIEVSUk9SID0gM1xyXG59XHJcblxyXG5jbGFzcyBMb2dnZXIge1xyXG4gIHByaXZhdGUgbGV2ZWw6IExvZ0xldmVsO1xyXG5cclxuICBjb25zdHJ1Y3RvcihsZXZlbDogTG9nTGV2ZWwgPSBMb2dMZXZlbC5JTkZPKSB7XHJcbiAgICB0aGlzLmxldmVsID0gbGV2ZWw7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGZvcm1hdE1lc3NhZ2UobGV2ZWw6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nLCBtZXRhPzogYW55KTogc3RyaW5nIHtcclxuICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcclxuICAgIGNvbnN0IG1ldGFTdHIgPSBtZXRhID8gYCAke0pTT04uc3RyaW5naWZ5KG1ldGEpfWAgOiAnJztcclxuICAgIHJldHVybiBgWyR7dGltZXN0YW1wfV0gJHtsZXZlbH06ICR7bWVzc2FnZX0ke21ldGFTdHJ9YDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgbG9nKGxldmVsOiBMb2dMZXZlbCwgbGV2ZWxOYW1lOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZywgbWV0YT86IGFueSkge1xyXG4gICAgaWYgKGxldmVsID49IHRoaXMubGV2ZWwpIHtcclxuICAgICAgY29uc3QgZm9ybWF0dGVkTWVzc2FnZSA9IHRoaXMuZm9ybWF0TWVzc2FnZShsZXZlbE5hbWUsIG1lc3NhZ2UsIG1ldGEpO1xyXG4gICAgICBcclxuICAgICAgc3dpdGNoIChsZXZlbCkge1xyXG4gICAgICAgIGNhc2UgTG9nTGV2ZWwuRVJST1I6XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGZvcm1hdHRlZE1lc3NhZ2UpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBMb2dMZXZlbC5XQVJOOlxyXG4gICAgICAgICAgY29uc29sZS53YXJuKGZvcm1hdHRlZE1lc3NhZ2UpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBMb2dMZXZlbC5JTkZPOlxyXG4gICAgICAgICAgY29uc29sZS5pbmZvKGZvcm1hdHRlZE1lc3NhZ2UpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBMb2dMZXZlbC5ERUJVRzpcclxuICAgICAgICAgIGNvbnNvbGUuZGVidWcoZm9ybWF0dGVkTWVzc2FnZSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZGVidWcobWVzc2FnZTogc3RyaW5nLCBtZXRhPzogYW55KSB7XHJcbiAgICB0aGlzLmxvZyhMb2dMZXZlbC5ERUJVRywgJ0RFQlVHJywgbWVzc2FnZSwgbWV0YSk7XHJcbiAgfVxyXG5cclxuICBpbmZvKG1lc3NhZ2U6IHN0cmluZywgbWV0YT86IGFueSkge1xyXG4gICAgdGhpcy5sb2coTG9nTGV2ZWwuSU5GTywgJ0lORk8nLCBtZXNzYWdlLCBtZXRhKTtcclxuICB9XHJcblxyXG4gIHdhcm4obWVzc2FnZTogc3RyaW5nLCBtZXRhPzogYW55KSB7XHJcbiAgICB0aGlzLmxvZyhMb2dMZXZlbC5XQVJOLCAnV0FSTicsIG1lc3NhZ2UsIG1ldGEpO1xyXG4gIH1cclxuXHJcbiAgZXJyb3IobWVzc2FnZTogc3RyaW5nLCBtZXRhPzogYW55KSB7XHJcbiAgICB0aGlzLmxvZyhMb2dMZXZlbC5FUlJPUiwgJ0VSUk9SJywgbWVzc2FnZSwgbWV0YSk7XHJcbiAgfVxyXG5cclxuICBzZXRMZXZlbChsZXZlbDogTG9nTGV2ZWwpIHtcclxuICAgIHRoaXMubGV2ZWwgPSBsZXZlbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBsb2dnZXIgPSBuZXcgTG9nZ2VyKFxyXG4gIHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gTG9nTGV2ZWwuREVCVUcgOiBMb2dMZXZlbC5JTkZPXHJcbik7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBsb2dnZXI7XHJcbiJdLCJuYW1lcyI6WyJMb2dMZXZlbCIsIkxvZ2dlciIsImNvbnN0cnVjdG9yIiwibGV2ZWwiLCJmb3JtYXRNZXNzYWdlIiwibWVzc2FnZSIsIm1ldGEiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJtZXRhU3RyIiwiSlNPTiIsInN0cmluZ2lmeSIsImxvZyIsImxldmVsTmFtZSIsImZvcm1hdHRlZE1lc3NhZ2UiLCJjb25zb2xlIiwiZXJyb3IiLCJ3YXJuIiwiaW5mbyIsImRlYnVnIiwic2V0TGV2ZWwiLCJsb2dnZXIiLCJwcm9jZXNzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/utils/logger.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fteams&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fteams%2Findex.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();